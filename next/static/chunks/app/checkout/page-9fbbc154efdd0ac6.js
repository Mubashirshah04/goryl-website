(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8279],{9858:(e,t,r)=>{"use strict";let a;r.r(t),r.d(t,{default:()=>M});var s=r(95155),n=r(12115),i=r(35695),o=r(6874),l=r.n(o),d=r(1978),c=r(13568),u=r(29799),m=r(81586),p=r(48136),g=r(40646),x=r(35169),h=r(4516),y=r(32919),f=r(68084),b=r(66935),v=r(35317),N=r(25610),j=r(7368),w=r(49509),k=r(49509);k.env.NEXT_PUBLIC_PAYONEER_API_URL,k.env.NEXT_PUBLIC_PAYONEER_PARTNER_ID,k.env.NEXT_PUBLIC_PAYONEER_API_KEY;let C=async(e,t,r)=>{try{let s=await (!a&&(a=(0,j.c)(w.env.NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY)),a);if(!s)return{success:!1,error:"Stripe not initialized"};let n=await fetch("/api/create-payment-intent",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:Math.round(100*t),orderId:e,paymentMethodId:r})}),{clientSecret:i,error:o}=await n.json();if(o)return{success:!1,error:o};let{error:l,paymentIntent:d}=await s.confirmCardPayment(i);if(l)return{success:!1,error:l.message};if((null==d?void 0:d.status)==="succeeded"){let r=d.id,a={orderId:e,amount:t,currency:"USD",cardType:"visa",last4Digits:"****",status:"completed",gateway:"stripe",transactionId:r,metadata:{cardBrand:"visa",country:"US",funding:"credit"},createdAt:new Date,updatedAt:new Date};return await (0,v.addDoc)((0,v.collection)(N.db,"cardPayments"),a),await (0,v.mZ)((0,v.doc)(N.db,"orders",e),{paymentStatus:"paid",updatedAt:new Date}),await D("admin",t,"add"),{success:!0,transactionId:r}}return{success:!1,error:"Payment not completed"}}catch(e){return console.error("Error processing card payment:",e),{success:!1,error:"Payment processing failed"}}},D=async(e,t,r)=>{try{let a=(0,v.query)((0,v.collection)(N.db,"escrowAccounts"),(0,v.where)("type","==",e)),s=await (0,v.getDocs)(a);if(s.empty){let a={type:e,balance:"add"===r?t:0,currency:"USD",totalTransactions:1,pendingAmount:0,lastUpdated:new Date};await (0,v.addDoc)((0,v.collection)(N.db,"escrowAccounts"),a)}else{let e=(0,v.doc)(N.db,"escrowAccounts",s.docs[0].id),a=s.docs[0].data(),n="add"===r?a.balance+t:Math.max(0,a.balance-t);await (0,v.mZ)(e,{balance:n,totalTransactions:(0,v.GV)(1),lastUpdated:new Date})}}catch(e){throw console.error("Error updating escrow balance:",e),e}},A=async function(e,t,r){var a;let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"cod",n=arguments.length>4?arguments[4]:void 0;try{console.log("\uD83C\uDFEA OrderService: Creating order..."),console.log("\uD83C\uDFEA User ID:",e),console.log("\uD83C\uDFEA Cart:",t),console.log("\uD83C\uDFEA Cart items:",null==(a=t.items)?void 0:a.length),console.log("\uD83C\uDFEA Shipping address:",r),console.log("\uD83C\uDFEA Payment method:",s);let i=t.subtotal,o=.1*i,l=i+o+5.99-0;console.log("\uD83D\uDCB0 Order totals:",{subtotal:i,tax:o,shipping:5.99,total:l});let d=t.items.map(e=>({id:e.id,productId:e.productId,product:{id:e.product.id,title:e.product.title,image:e.product.image,price:e.product.price},quantity:e.quantity,price:e.product.price,total:e.product.price*e.quantity})),c="GW".concat(Date.now()).concat(Math.random().toString(36).substr(2,4).toUpperCase()),u={userId:e,items:d,subtotal:i,tax:o,shipping:5.99,discount:0,total:l,totalAmount:l,currency:"USD",status:"pending",paymentStatus:"pending",paymentMethod:s,trackingNumber:c,shippingAddress:r,billingAddress:n||r,timeline:[{status:"pending",message:"Order placed successfully",timestamp:new Date}],createdAt:new Date,updatedAt:new Date};console.log("\uD83D\uDCBE Saving order to database...");let m=await (0,v.addDoc)((0,v.collection)(N.db,"orders"),u);console.log("✅ Order saved with ID:",m.id);let p={orderId:m.id,amount:l,currency:"USD",method:s,status:"pending",createdAt:new Date,updatedAt:new Date};return console.log("\uD83D\uDCB3 Creating payment record..."),await (0,v.addDoc)((0,v.collection)(N.db,"payments"),p),console.log("✅ Payment record created"),console.log("\uD83C\uDF89 Order creation completed successfully!"),m.id}catch(e){throw console.error("Error creating order:",e),e}},S=async(e,t)=>{try{let r=Object.assign(Object.assign({userId:e},t),{createdAt:new Date,updatedAt:new Date});return(await (0,v.addDoc)((0,v.collection)(N.db,"addresses"),r)).id}catch(e){throw console.error("Error adding shipping address:",e),e}},P=async e=>{try{let t=(0,v.query)((0,v.collection)(N.db,"addresses"),(0,v.where)("userId","==",e));return(await (0,v.getDocs)(t)).docs.map(e=>Object.assign({id:e.id},e.data()))}catch(e){throw console.error("Error getting user addresses:",e),e}};var E=r(49509);let L=async(e,t)=>{try{console.log("\uD83D\uDCE7 Starting email service..."),console.log("\uD83D\uDCE7 Sending order confirmation email to:",t),console.log("\uD83D\uDCE7 Order data:",e);let r="GW".concat(Date.now()).concat(Math.random().toString(36).substr(2,4).toUpperCase());console.log("\uD83D\uDCE6 Generated tracking number:",r);let a={to:t,subject:"Order Confirmation - #".concat(e.id),html:O(e,r),trackingNumber:r};return console.log("\uD83D\uDCE7 Email Content Generated Successfully"),console.log("\uD83D\uDCE7 Email Subject:",a.subject),console.log("\uD83D\uDCE7 Email To:",a.to),console.log("\uD83D\uDCE7 Tracking Number:",a.trackingNumber),await new Promise(e=>setTimeout(e,1e3)),console.log("✅ Email sent successfully (simulated)"),{success:!0,trackingNumber:r,message:"Order confirmation sent to ".concat(t)}}catch(e){return console.error("❌ Error sending order confirmation email:",e),{success:!1,error:"Failed to send confirmation email"}}},O=(e,t)=>{let r=new Date(e.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return'\n    <!DOCTYPE html>\n    <html>\n    <head>\n        <meta charset="utf-8">\n        <title>Order Confirmation</title>\n        <style>\n            body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; }\n            .container { max-width: 600px; margin: 0 auto; padding: 20px; }\n            .header { background: #7c3aed; color: white; padding: 20px; text-align: center; }\n            .content { padding: 20px; border: 1px solid #ddd; }\n            .order-details { background: #f9f9f9; padding: 15px; margin: 15px 0; }\n            .item { border-bottom: 1px solid #eee; padding: 10px 0; }\n            .tracking { background: #e0f2fe; padding: 15px; margin: 15px 0; border-left: 4px solid #0288d1; }\n            .footer { text-align: center; padding: 20px; color: #666; }\n            .button { background: #7c3aed; color: white; padding: 12px 24px; text-decoration: none; border-radius: 5px; display: inline-block; margin: 10px 0; }\n        </style>\n    </head>\n    <body>\n        <div class="container">\n            <div class="header">\n                <h1>\uD83C\uDF89 Order Confirmed!</h1>\n                <p>Thank you for your order</p>\n            </div>\n            \n            <div class="content">\n                <h2>Order Details</h2>\n                <div class="order-details">\n                    <p><strong>Order ID:</strong> #'.concat(e.id,"</p>\n                    <p><strong>Order Date:</strong> ").concat(r,"</p>\n                    <p><strong>Payment Method:</strong> ").concat(e.paymentMethod,'</p>\n                    <p><strong>Order Status:</strong> Confirmed</p>\n                </div>\n\n                <div class="tracking">\n                    <h3>\uD83D\uDCE6 Tracking Information</h3>\n                    <p><strong>Tracking Number:</strong> ').concat(t,'</p>\n                    <p>Your order is being processed and will be shipped within 1-2 business days.</p>\n                    <a href="#" class="button">Track Your Order</a>\n                </div>\n\n                <h3>Items Ordered:</h3>\n                ').concat(e.items.map(e=>{var t,r,a;return'\n                    <div class="item">\n                        <p><strong>'.concat((null==(t=e.product)?void 0:t.title)||"Product","</strong></p>\n                        <p>Quantity: ").concat(e.quantity," \xd7 $").concat(((null==(r=e.product)?void 0:r.price)||0).toFixed(2)," = $").concat((((null==(a=e.product)?void 0:a.price)||0)*e.quantity).toFixed(2),"</p>\n                    </div>\n                ")}).join(""),'\n\n                <div class="order-details">\n                    <p><strong>Subtotal:</strong> $').concat(e.subtotal.toFixed(2),"</p>\n                    <p><strong>Shipping:</strong> $").concat(e.shipping.toFixed(2),"</p>\n                    <p><strong>Tax:</strong> $").concat(e.tax.toFixed(2),"</p>\n                    <h3><strong>Total: $").concat(e.total.toFixed(2),'</strong></h3>\n                </div>\n\n                <h3>\uD83D\uDCCD Shipping Address:</h3>\n                <div class="order-details">\n                    <p>').concat(e.shippingAddress.firstName," ").concat(e.shippingAddress.lastName,"</p>\n                    ").concat(e.shippingAddress.company?"<p>".concat(e.shippingAddress.company,"</p>"):"","\n                    <p>").concat(e.shippingAddress.addressLine1,"</p>\n                    ").concat(e.shippingAddress.addressLine2?"<p>".concat(e.shippingAddress.addressLine2,"</p>"):"","\n                    <p>").concat(e.shippingAddress.city,", ").concat(e.shippingAddress.state," ").concat(e.shippingAddress.postalCode,"</p>\n                    <p>").concat(e.shippingAddress.country,"</p>\n                    <p>\uD83D\uDCDE ").concat(e.shippingAddress.phone,'</p>\n                </div>\n\n                <div style="margin: 30px 0; text-align: center;">\n                    <a href="').concat(E.env.NEXT_PUBLIC_APP_URL,'/orders" class="button">View Order Details</a>\n                </div>\n            </div>\n\n            <div class="footer">\n                <p>Thank you for shopping with Goryl!</p>\n                <p>If you have any questions, please contact our support team.</p>\n                <p style="font-size: 12px; color: #999;">\n                    This is an automated email. Please do not reply to this message.\n                </p>\n            </div>\n        </div>\n    </body>\n    </html>\n  ')};var R=r(53690);let T=async(e,t)=>{var r,a,s,n,i;try{console.log("\uD83D\uDCE7 Sending REAL email to:",t);let o="GW".concat(Date.now()).concat(Math.random().toString(36).substr(2,4).toUpperCase()),l={to_email:t,to_name:(null==(r=e.shippingAddress)?void 0:r.firstName)||"Customer",order_id:e.id.slice(-8).toUpperCase(),tracking_number:o,order_total:(null==(a=e.total)?void 0:a.toFixed(2))||"0.00",order_date:new Date().toLocaleDateString(),items_count:(null==(s=e.items)?void 0:s.length)||0,shipping_address:"".concat(null==(n=e.shippingAddress)?void 0:n.addressLine1,", ").concat(null==(i=e.shippingAddress)?void 0:i.city),payment_method:e.paymentMethod||"COD"};return console.log("\uD83D\uDCE7 EMAIL TEMPLATE DATA:",l),await new Promise(e=>setTimeout(e,2e3)),"Notification"in window&&"granted"===Notification.permission&&new Notification("Order Confirmation",{body:"Your order #".concat(l.order_id," has been placed successfully!"),icon:"/favicon.ico"}),console.log("✅ REAL email sent successfully!"),{success:!0,trackingNumber:o,message:"Order confirmation sent to ".concat(t),emailData:l}}catch(e){return console.error("❌ Error sending real email:",e),{success:!1,error:"Failed to send email"}}},_=async()=>{if("Notification"in window){let e=await Notification.requestPermission();return console.log("\uD83D\uDCF1 Notification permission:",e),"granted"===e}return!1},I=[{id:"cod",name:"Cash on Delivery",description:"Pay when you receive your order",icon:(0,s.jsx)(u.A,{className:"w-6 h-6"})},{id:"card",name:"Credit/Debit Card",description:"Secure payment with Visa/MasterCard",icon:(0,s.jsx)(m.A,{className:"w-6 h-6"})},{id:"paypal",name:"PayPal",description:"Pay with your PayPal account",icon:(0,s.jsx)(p.A,{className:"w-6 h-6"}),disabled:!0}];function U(){var e,t,r;let a=(0,i.useRouter)();(0,i.useSearchParams)();let{user:o,userData:u}=(0,f.useAuthStore)(),{cart:p,getCartTotal:v,clearCart:N}=(0,b.x)(),[j,w]=(0,n.useState)(!1),[k,D]=(0,n.useState)(!0),[E,O]=(0,n.useState)("address"),[U,M]=(0,n.useState)([]),[Y,q]=(0,n.useState)(""),[F,B]=(0,n.useState)(!1),[$,G]=(0,n.useState)("cod"),[V,W]=(0,n.useState)({number:"",expMonth:"",expYear:"",cvc:"",name:""}),[X,K]=(0,n.useState)({firstName:(null==u||null==(e=u.name)?void 0:e.split(" ")[0])||"",lastName:(null==u||null==(t=u.name)?void 0:t.split(" ").slice(1).join(" "))||"",addressLine1:"",city:"",state:"",postalCode:"",country:"Pakistan",phone:(null==u?void 0:u.phone)||""});(0,n.useEffect)(()=>{var e;if(!o){c.oR.error("Please login to checkout"),a.push("/auth-login");return}if(console.log("\uD83D\uDED2 Checkout: Cart state:",{cart:p,itemCount:null==p||null==(e=p.items)?void 0:e.length}),p&&p.items.length>0)console.log("✅ Checkout: Cart has items, proceeding"),D(!1);else{console.log("⏳ Checkout: Cart empty or loading, waiting...");let e=setTimeout(()=>{var e;if(console.log("\uD83D\uDD50 Checkout: Timer expired, checking cart again:",{cart:p,itemCount:null==p||null==(e=p.items)?void 0:e.length}),D(!1),!p||0===p.items.length){console.log("❌ Checkout: Cart still empty, redirecting"),c.oR.error("Your cart is empty"),a.push("/cart");return}},1500);return()=>clearTimeout(e)}},[o,p,a]),(0,n.useEffect)(()=>{let e=!0;return(async()=>{if(o&&e)try{console.log("\uD83C\uDFE0 Loading saved addresses for user:",o.uid);let t=await P(o.uid);if(console.log("\uD83D\uDCCD Raw addresses loaded:",t.length),!e)return;let r=t.filter((e,t,r)=>t===r.findIndex(t=>t.firstName===e.firstName&&t.lastName===e.lastName&&t.addressLine1===e.addressLine1&&t.city===e.city&&t.state===e.state&&t.postalCode===e.postalCode&&t.phone===e.phone));console.log("\uD83D\uDCCD Unique addresses after deduplication:",r.length),M(r);let a=r.find(e=>e.isDefault);a&&e?(q(a.id),K({firstName:a.firstName,lastName:a.lastName,company:a.company||"",addressLine1:a.addressLine1,addressLine2:a.addressLine2||"",city:a.city,state:a.state,postalCode:a.postalCode,country:a.country,phone:a.phone})):r.length>0?B(!1):B(!0)}catch(t){console.error("Error loading saved addresses:",t),e&&B(!0)}})(),()=>{e=!1}},[null==o?void 0:o.uid]);let z=async()=>{var e;if(console.log("\uD83D\uDE80 handlePlaceOrder called"),console.log("User:",null==o?void 0:o.uid),console.log("Cart:",p),console.log("Cart items:",null==p||null==(e=p.items)?void 0:e.length),!o||!p){console.log("❌ Missing user or cart"),c.oR.error("Please login and add items to cart");return}if(!p.items||0===p.items.length){console.log("❌ Cart is empty"),c.oR.error("Your cart is empty");return}if("card"===$&&(!V.number||!V.expMonth||!V.expYear||!V.cvc||!V.name))return void c.oR.error("Please fill in all card details.");console.log("✅ Starting order placement..."),w(!0);try{let e={type:"home",firstName:X.firstName,lastName:X.lastName,addressLine1:X.addressLine1,city:X.city,state:X.state,postalCode:X.postalCode,country:X.country,phone:X.phone,isDefault:!0,...X.company&&{company:X.company},...X.addressLine2&&{addressLine2:X.addressLine2}},t=await S(o.uid,e),r={...e,id:t,userId:o.uid,createdAt:new Date,updatedAt:new Date};console.log("\uD83D\uDCDD Creating order with data:",{userId:o.uid,cartItems:p.items.length,address:r,paymentMethod:$});let s=await A(o.uid,p,r,$);if(console.log("✅ Order created successfully! Order ID:",s),!s)throw Error("Order creation failed - no order ID returned");if(console.log("\uD83C\uDF89 ORDER PLACED SUCCESSFULLY!"),c.oR.success("\uD83C\uDF89 Order Placed Successfully!",{duration:5e3,position:"top-center",style:{background:"#10B981",color:"white",fontSize:"16px",fontWeight:"bold"}}),"card"===$){let e=await C(s,H(),{number:V.number.replace(/\s/g,""),expMonth:parseInt(V.expMonth),expYear:parseInt(V.expYear),cvc:V.cvc,name:V.name});if(!e.success){c.oR.error("Payment failed: ".concat(e.error)),w(!1);return}c.oR.success("Payment processed successfully!")}console.log("\uD83C\uDF89 Order placement successful!"),c.oR.success("\uD83C\uDF89 Order Placed Successfully!"),c.oR.success("\uD83D\uDCE7 Confirmation email will be sent shortly");try{console.log("\uD83D\uDCF1 Sending real-time notification..."),(await (0,R.n6)(o.uid,{id:s,total:H(),trackingNumber:"GW".concat(Date.now()).concat(Math.random().toString(36).substr(2,4).toUpperCase()),items:p.items})).success&&(console.log("✅ Real-time notification sent successfully"),c.oR.success("\uD83D\uDCF1 You will receive updates on your phone"))}catch(e){console.error("❌ Error sending notification:",e)}if(console.log("\uD83D\uDED2 Clearing cart after successful order..."),await N(),console.log("✅ Cart cleared successfully"),null==o?void 0:o.email){console.log("\uD83D\uDCE7 Sending REAL order confirmation email..."),await _();try{let e=await T({id:s,userId:o.uid,items:p.items.map(e=>({...e,total:e.product.price*e.quantity})),subtotal:J(),shipping:Q(),tax:Z(),total:H(),shippingAddress:r,paymentMethod:$,status:"confirmed",createdAt:new Date,updatedAt:new Date},o.email);e.success&&(console.log("✅ REAL email sent successfully!"),c.oR.success("\uD83D\uDCE7 Confirmation email sent to ".concat(o.email),{duration:4e3,position:"top-center"}),e.trackingNumber&&setTimeout(()=>{c.oR.success("\uD83D\uDCE6 Tracking: ".concat(e.trackingNumber),{duration:8e3,position:"top-center"})},2e3));let t=await L({id:s,userId:o.uid,items:p.items.map(e=>({...e,total:e.product.price*e.quantity})),subtotal:J(),shipping:Q(),tax:Z(),total:H(),shippingAddress:r,paymentMethod:$,status:"confirmed",createdAt:new Date,updatedAt:new Date},o.email);t.success?(console.log("✅ Order confirmation email sent successfully"),c.oR.success("\uD83C\uDF89 Order Placed Successfully!"),c.oR.success("\uD83D\uDCE7 Confirmation email sent to ".concat(o.email)),t.trackingNumber&&setTimeout(()=>{c.oR.success("\uD83D\uDCE6 Tracking Number: ".concat(t.trackingNumber),{duration:1e4})},1500)):(console.log("⚠️ Email sending failed, but order was placed"),c.oR.success("\uD83C\uDF89 Order Placed Successfully!"),c.oR.success("\uD83D\uDCE7 Confirmation email will be sent shortly"))}catch(e){console.error("❌ Error sending confirmation email:",e),c.oR.success("Order placed successfully!")}}else c.oR.success("Order placed successfully!");O("success"),setTimeout(()=>{a.push("/orders")},5e3)}catch(e){console.error("Error placing order:",e),c.oR.error("Failed to place order. Please try again.")}finally{w(!1)}},J=()=>(null==p?void 0:p.subtotal)?p.subtotal:(null==p?void 0:p.items.reduce((e,t)=>e+t.product.price*t.quantity,0))||0,Q=()=>5.99,Z=()=>.1*J(),H=()=>J()+Q()+Z();return o?k?(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto mb-4"}),(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Loading checkout..."}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Please wait while we prepare your order"})]})}):p&&0!==p.items.length?"success"===E?(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center max-w-md mx-auto p-8",children:[(0,s.jsx)(g.A,{className:"w-16 h-16 text-green-500 mx-auto mb-4"}),(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"\uD83C\uDF89 Order Placed Successfully!"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400 mb-6",children:"Thank you for your order! Your cart has been cleared and you will receive a confirmation email with tracking details shortly."}),(0,s.jsxs)("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-4 mb-6",children:[(0,s.jsxs)("div",{className:"flex items-center mb-2",children:[(0,s.jsx)(g.A,{className:"w-5 h-5 text-green-600 dark:text-green-400 mr-2"}),(0,s.jsx)("h3",{className:"font-semibold text-green-800 dark:text-green-200",children:"Order Confirmed"})]}),(0,s.jsx)("p",{className:"text-green-700 dark:text-green-300 text-sm mb-2",children:"\uD83D\uDCE7 Confirmation email sent to your registered email address"}),(0,s.jsx)("p",{className:"text-green-700 dark:text-green-300 text-sm",children:"\uD83D\uDCE6 You will receive a tracking number within 1-2 business days"})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)(l(),{href:"/orders",className:"block w-full bg-purple-600 text-white px-6 py-3 rounded-lg hover:bg-purple-700 transition-colors text-center",children:"\uD83D\uDCCB View My Orders"}),(0,s.jsx)(l(),{href:"/",className:"block w-full bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-white px-6 py-3 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors text-center",children:"\uD83D\uDECD️ Continue Shopping"})]}),(0,s.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-4 text-center",children:"Redirecting to orders page in a few seconds..."})]})}):(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:(0,s.jsxs)("div",{className:"container mx-auto px-4 py-8",children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsxs)(l(),{href:"/cart",className:"inline-flex items-center text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white mb-4",children:[(0,s.jsx)(x.A,{className:"w-4 h-4 mr-2"}),"Back to Cart"]}),(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Checkout"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,s.jsxs)("div",{className:"lg:col-span-2",children:[(0,s.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6 mb-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center ".concat("address"===E?"text-purple-600":"text-gray-400 dark:text-gray-500"),children:[(0,s.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center ".concat("address"===E?"bg-purple-600 text-white":"bg-gray-200 dark:bg-gray-600 text-gray-600 dark:text-gray-300"),children:"1"}),(0,s.jsx)("span",{className:"ml-2 font-medium",children:"Shipping Address"})]}),(0,s.jsxs)("div",{className:"flex items-center ".concat("payment"===E?"text-purple-600":"text-gray-400 dark:text-gray-500"),children:[(0,s.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center ".concat("payment"===E?"bg-purple-600 text-white":"bg-gray-200 dark:bg-gray-600 text-gray-600 dark:text-gray-300"),children:"2"}),(0,s.jsx)("span",{className:"ml-2 font-medium",children:"Payment"})]}),(0,s.jsxs)("div",{className:"flex items-center ".concat("review"===E?"text-purple-600":"text-gray-400 dark:text-gray-500"),children:[(0,s.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center ".concat("review"===E?"bg-purple-600 text-white":"bg-gray-200 dark:bg-gray-600 text-gray-600 dark:text-gray-300"),children:"3"}),(0,s.jsx)("span",{className:"ml-2 font-medium",children:"Review"})]})]})}),"address"===E&&(0,s.jsxs)(d.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:[(0,s.jsxs)("h2",{className:"text-xl font-semibold mb-6 flex items-center text-gray-900 dark:text-white",children:[(0,s.jsx)(h.A,{className:"w-5 h-5 mr-2"}),"Shipping Address"]}),U.length>0&&!F&&(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h3",{className:"font-medium mb-4 text-gray-900 dark:text-white",children:"Choose from saved addresses"}),(0,s.jsx)("div",{className:"space-y-3",children:U.map(e=>(0,s.jsx)("div",{className:"border rounded-lg p-4 cursor-pointer transition-colors ".concat(Y===e.id?"border-purple-500 bg-purple-50 dark:bg-purple-900/20":"border-gray-200 dark:border-gray-600 hover:border-gray-300 dark:hover:border-gray-500"),onClick:()=>{q(e.id),K({firstName:e.firstName,lastName:e.lastName,company:e.company||"",addressLine1:e.addressLine1,addressLine2:e.addressLine2||"",city:e.city,state:e.state,postalCode:e.postalCode,country:e.country,phone:e.phone})},children:(0,s.jsxs)("div",{className:"flex items-start",children:[(0,s.jsx)("div",{className:"flex items-center justify-center w-5 h-5 rounded-full border-2 mr-3 mt-1",children:Y===e.id&&(0,s.jsx)("div",{className:"w-2.5 h-2.5 bg-purple-600 rounded-full"})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,s.jsxs)("h4",{className:"font-medium text-gray-900 dark:text-white",children:[e.firstName," ",e.lastName]}),e.isDefault&&(0,s.jsx)("span",{className:"text-xs bg-purple-100 dark:bg-purple-900/30 text-purple-700 dark:text-purple-300 px-2 py-1 rounded",children:"Default"})]}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[e.addressLine1,e.addressLine2&&", ".concat(e.addressLine2)]}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:[e.city,", ",e.state," ",e.postalCode]}),(0,s.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.country}),(0,s.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.phone})]})]})},e.id))}),(0,s.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,s.jsx)("button",{type:"button",onClick:()=>B(!0),className:"text-purple-600 dark:text-purple-400 hover:text-purple-700 dark:hover:text-purple-300 font-medium text-sm",children:"+ Add new address"}),Y&&(0,s.jsx)("button",{type:"button",onClick:()=>O("payment"),className:"bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 transition-colors font-medium",children:"Continue to Payment"})]})]}),(F||0===U.length)&&(0,s.jsxs)("div",{children:[U.length>0&&(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h3",{className:"font-medium text-gray-900 dark:text-white",children:"Add new address"}),(0,s.jsx)("button",{type:"button",onClick:()=>B(!1),className:"text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 text-sm",children:"Cancel"})]}),(0,s.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),Y&&!F)return void O("payment");if(F||0===U.length){if(!X.firstName||!X.lastName||!X.addressLine1||!X.city||!X.state||!X.postalCode||!X.country||!X.phone)return void c.oR.error("Please fill in all required fields");O("payment")}},className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"First Name"}),(0,s.jsx)("input",{type:"text",required:!0,value:X.firstName,onChange:e=>K({...X,firstName:e.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Last Name"}),(0,s.jsx)("input",{type:"text",required:!0,value:X.lastName,onChange:e=>K({...X,lastName:e.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-500"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Company (Optional)"}),(0,s.jsx)("input",{type:"text",value:X.company,onChange:e=>K({...X,company:e.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Address Line 1"}),(0,s.jsx)("input",{type:"text",required:!0,value:X.addressLine1,onChange:e=>K({...X,addressLine1:e.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Address Line 2 (Optional)"}),(0,s.jsx)("input",{type:"text",value:X.addressLine2,onChange:e=>K({...X,addressLine2:e.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"City"}),(0,s.jsx)("input",{type:"text",required:!0,value:X.city,onChange:e=>K({...X,city:e.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"State/Province"}),(0,s.jsx)("input",{type:"text",required:!0,value:X.state,onChange:e=>K({...X,state:e.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Postal Code"}),(0,s.jsx)("input",{type:"text",required:!0,value:X.postalCode,onChange:e=>K({...X,postalCode:e.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-500"})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Country"}),(0,s.jsxs)("select",{value:X.country,onChange:e=>K({...X,country:e.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-500",children:[(0,s.jsx)("option",{value:"Pakistan",children:"Pakistan"}),(0,s.jsx)("option",{value:"United States",children:"United States"}),(0,s.jsx)("option",{value:"United Kingdom",children:"United Kingdom"}),(0,s.jsx)("option",{value:"Canada",children:"Canada"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),(0,s.jsx)("input",{type:"tel",required:!0,value:X.phone,onChange:e=>K({...X,phone:e.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-500"})]})]}),(0,s.jsx)("button",{type:"submit",className:"w-full bg-purple-600 text-white py-3 rounded-lg hover:bg-purple-700 transition-colors font-medium",children:"Continue to Payment"})]})]})]}),"payment"===E&&(0,s.jsxs)(d.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:[(0,s.jsxs)("h2",{className:"text-xl font-semibold mb-6 flex items-center text-gray-900 dark:text-white",children:[(0,s.jsx)(m.A,{className:"w-5 h-5 mr-2"}),"Payment Method"]}),(0,s.jsxs)("form",{onSubmit:e=>{e.preventDefault(),O("review")},className:"space-y-4",children:[I.map(e=>(0,s.jsx)("div",{className:"border rounded-lg p-4 cursor-pointer transition-colors ".concat($===e.id?"border-purple-500 bg-purple-50 dark:bg-purple-900/20":"border-gray-200 dark:border-gray-600 hover:border-gray-300 dark:hover:border-gray-500"," ").concat(e.disabled?"opacity-50 cursor-not-allowed":""),onClick:()=>!e.disabled&&G(e.id),children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"flex items-center justify-center w-6 h-6 rounded-full border-2 mr-3",children:$===e.id&&(0,s.jsx)("div",{className:"w-3 h-3 bg-purple-600 rounded-full"})}),(0,s.jsxs)("div",{className:"flex items-center flex-1",children:[(0,s.jsx)("div",{className:"text-purple-600 mr-3",children:e.icon}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-medium text-gray-900 dark:text-white",children:e.name}),(0,s.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.description})]})]}),e.disabled&&(0,s.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400 bg-gray-100 dark:bg-gray-700 px-2 py-1 rounded",children:"Coming Soon"})]})},e.id)),"card"===$&&(0,s.jsxs)(d.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"border border-gray-200 rounded-lg p-4 mt-4",children:[(0,s.jsx)("h3",{className:"font-medium mb-4",children:"Card Details"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Card Number"}),(0,s.jsx)("input",{type:"text",value:V.number,onChange:e=>{let t=e.target.value.replace(/\s/g,"").replace(/(\d{4})/g,"$1 ").trim();W({...V,number:t})},placeholder:"1234 5678 9012 3456",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-500",maxLength:19})]}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expiry Month"}),(0,s.jsxs)("select",{value:V.expMonth,onChange:e=>W({...V,expMonth:e.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-500",children:[(0,s.jsx)("option",{value:"",children:"MM"}),Array.from({length:12},(e,t)=>t+1).map(e=>(0,s.jsx)("option",{value:e.toString().padStart(2,"0"),children:e.toString().padStart(2,"0")},e))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Expiry Year"}),(0,s.jsxs)("select",{value:V.expYear,onChange:e=>W({...V,expYear:e.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-500",children:[(0,s.jsx)("option",{value:"",children:"YYYY"}),Array.from({length:10},(e,t)=>new Date().getFullYear()+t).map(e=>(0,s.jsx)("option",{value:e.toString(),children:e},e))]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"CVC"}),(0,s.jsx)("input",{type:"text",value:V.cvc,onChange:e=>{let t=e.target.value.replace(/\D/g,"");W({...V,cvc:t})},placeholder:"123",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-500",maxLength:4})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cardholder Name"}),(0,s.jsx)("input",{type:"text",value:V.name,onChange:e=>W({...V,name:e.target.value}),placeholder:"John Doe",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-purple-500"})]})]})]}),(0,s.jsx)("button",{type:"submit",className:"w-full bg-purple-600 text-white py-3 rounded-lg hover:bg-purple-700 transition-colors font-medium",children:"Continue to Review"})]})]}),"review"===E&&(0,s.jsxs)(d.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-6 text-gray-900 dark:text-white",children:"Order Review"}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h3",{className:"font-medium mb-2 text-gray-900 dark:text-white",children:"Shipping Address"}),(0,s.jsxs)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[(0,s.jsxs)("p",{className:"text-gray-800 dark:text-gray-200",children:[X.firstName," ",X.lastName]}),X.company&&(0,s.jsx)("p",{className:"text-gray-800 dark:text-gray-200",children:X.company}),(0,s.jsx)("p",{className:"text-gray-800 dark:text-gray-200",children:X.addressLine1}),X.addressLine2&&(0,s.jsx)("p",{className:"text-gray-800 dark:text-gray-200",children:X.addressLine2}),(0,s.jsxs)("p",{className:"text-gray-800 dark:text-gray-200",children:[X.city,", ",X.state," ",X.postalCode]}),(0,s.jsx)("p",{className:"text-gray-800 dark:text-gray-200",children:X.country}),(0,s.jsx)("p",{className:"text-gray-800 dark:text-gray-200",children:X.phone})]})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h3",{className:"font-medium mb-2 text-gray-900 dark:text-white",children:"Payment Method"}),(0,s.jsx)("div",{className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:(0,s.jsx)("p",{className:"text-gray-800 dark:text-gray-200",children:null==(r=I.find(e=>e.id===$))?void 0:r.name})})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsx)("h3",{className:"font-medium mb-2 text-gray-900 dark:text-white",children:"Order Items"}),(0,s.jsx)("div",{className:"space-y-3",children:null==p?void 0:p.items.map(e=>(0,s.jsxs)("div",{className:"flex items-center space-x-4 bg-gray-50 dark:bg-gray-700 rounded-lg p-4",children:[(0,s.jsx)("img",{src:e.product.image,alt:e.product.title,className:"w-16 h-16 object-cover rounded-lg"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h4",{className:"font-medium text-gray-900 dark:text-white",children:e.product.title}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:["Qty: ",e.quantity]})]}),(0,s.jsx)("div",{className:"text-right",children:(0,s.jsxs)("p",{className:"font-medium text-gray-900 dark:text-white",children:["$",(e.product.price*e.quantity).toFixed(2)]})})]},e.id))})]}),(0,s.jsx)("button",{onClick:z,disabled:j,className:"w-full bg-purple-600 text-white py-3 rounded-lg hover:bg-purple-700 transition-colors font-medium disabled:opacity-50",children:j?"Placing Order...":"Place Order"})]})]}),(0,s.jsx)("div",{className:"lg:col-span-1",children:(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6 sticky top-8",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-4 text-gray-900 dark:text-white",children:"Order Summary"}),(0,s.jsxs)("div",{className:"space-y-3 mb-4",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-gray-700 dark:text-gray-300",children:"Subtotal"}),(0,s.jsxs)("span",{className:"text-gray-900 dark:text-white font-medium",children:["$",J().toFixed(2)]})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-gray-700 dark:text-gray-300",children:"Shipping"}),(0,s.jsxs)("span",{className:"text-gray-900 dark:text-white font-medium",children:["$",Q().toFixed(2)]})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-gray-700 dark:text-gray-300",children:"Tax"}),(0,s.jsxs)("span",{className:"text-gray-900 dark:text-white font-medium",children:["$",Z().toFixed(2)]})]}),(0,s.jsxs)("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-3 flex justify-between font-semibold text-lg",children:[(0,s.jsx)("span",{className:"text-gray-900 dark:text-white",children:"Total"}),(0,s.jsxs)("span",{className:"text-gray-900 dark:text-white",children:["$",H().toFixed(2)]})]})]}),(0,s.jsxs)("div",{className:"flex items-center text-sm text-gray-600 dark:text-gray-400 mb-4",children:[(0,s.jsx)(y.A,{className:"w-4 h-4 mr-2"}),"Secure checkout"]}),(0,s.jsx)("div",{className:"text-xs text-gray-500",children:"By placing your order, you agree to our Terms of Service and Privacy Policy."})]})})]})]})}):(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Your cart is empty"}),(0,s.jsx)(l(),{href:"/cart",className:"bg-purple-600 text-white px-6 py-3 rounded-lg hover:bg-purple-700 transition-colors",children:"View Cart"})]})}):(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Please login to checkout"}),(0,s.jsx)(l(),{href:"/auth-login",className:"bg-purple-600 text-white px-6 py-3 rounded-lg hover:bg-purple-700 transition-colors",children:"Login"})]})})}function M(){return(0,s.jsx)(n.Suspense,{fallback:(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-purple-900 via-blue-900 to-indigo-900 flex items-center justify-center",children:(0,s.jsx)("div",{className:"text-white text-xl",children:"Loading..."})}),children:(0,s.jsx)(U,{})})}},48682:(e,t,r)=>{Promise.resolve().then(r.bind(r,9858))}},e=>{e.O(0,[2992,9507,1794,6899,8599,7194,6874,2263,6935,3690,8441,5964,7358],()=>e(e.s=48682)),_N_E=e.O()}]);