(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2227],{15273:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(19946).A)("volume-2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]])},33681:(e,t,r)=>{"use strict";r.d(t,{q:()=>m});var s=r(88693),o=r(35317),l=r(25610);let i=()=>new Promise(e=>{let t=l.j2.onAuthStateChanged(r=>{t(),e(r)});setTimeout(()=>{t(),e(null)},5e3)}),a=()=>{var e;return(null==(e=l.j2.currentUser)?void 0:e.uid)||null},n=async(e,t)=>{try{if(!e)throw Error("User ID is required");if(!l.j2.currentUser||a()!==e){let t=await i();if(!t||t.uid!==e)throw Error("Permission denied. Please make sure you are logged in.")}console.log("Adding product to wishlist for user:",e);let r=(0,o.doc)(l.db,"wishlists",e),s=await (0,o.x7)(r),n={items:[],updatedAt:(0,o.serverTimestamp)()};s.exists()&&(n=s.data());let d=n.items.findIndex(e=>e.productId===t.id);if(-1!==d)throw Error("Product already in wishlist");let c={id:t.id,userId:e,productId:t.id,product:t,addedAt:new Date};n.items.push(c),await (0,o.mZ)(r,{items:n.items,updatedAt:(0,o.serverTimestamp)()}),console.log("Successfully added product to wishlist for user:",e)}catch(e){if(console.error("Error adding to wishlist:",e),e.code){if("permission-denied"===e.code)throw Error("Permission denied. Please make sure you are logged in.");throw e}throw Error(e.message||"Failed to add item to wishlist")}},d=async(e,t)=>{try{if(!e)throw Error("User ID is required");if(!l.j2.currentUser||a()!==e){let t=await i();if(!t||t.uid!==e)throw Error("Permission denied. Please make sure you are logged in.")}console.log("Removing product from wishlist for user:",e,"product:",t);let r=(0,o.doc)(l.db,"wishlists",e),s=await (0,o.x7)(r);if(!s.exists())return void console.log("Wishlist document does not exist for user:",e);let n=s.data().items.filter(e=>e.productId!==t);await (0,o.mZ)(r,{items:n,updatedAt:(0,o.serverTimestamp)()}),console.log("Successfully removed product from wishlist for user:",e)}catch(e){if(console.error("Error removing from wishlist:",e),e.code){if("permission-denied"===e.code)throw Error("Permission denied. Please make sure you are logged in.");throw e}throw Error(e.message||"Failed to remove item from wishlist")}},c=async e=>{try{if(!e)throw Error("User ID is required");if(!l.j2.currentUser||a()!==e){let t=await i();if(!t||t.uid!==e)throw Error("Permission denied. Please make sure you are logged in.")}console.log("Attempting to fetch wishlist for user:",e);let t=(0,o.doc)(l.db,"wishlists",e),r=await (0,o.x7)(t);if(!r.exists())return console.log("Wishlist document does not exist for user:",e),[];let s=r.data();return console.log("Successfully fetched wishlist for user:",e),s.items||[]}catch(e){if(console.error("Error getting user wishlist:",e),e.code){if("permission-denied"===e.code)throw Error("Permission denied. Please make sure you are logged in.");throw e}throw Error(e.message||"Failed to load wishlist")}};var u=r(68084);let h=new Set,m=(0,s.vt)((e,t)=>({wishlist:[],loading:!1,error:null,setWishlist:t=>e({wishlist:t}),setLoading:t=>e({loading:t}),setError:t=>e({error:t}),initializeWishlist:async t=>{if(!t)return void e({error:"User not authenticated",loading:!1});if(!h.has(t)){h.add(t),console.log("Initializing wishlist for:",t),e({loading:!0,error:null});try{let r=await c(t);e({wishlist:r,loading:!1}),console.log("Wishlist initialized successfully for:",t);let s=((e,t)=>{if(!e)return console.error("User ID is required for wishlist subscription"),t([]),()=>{};if(!l.j2.currentUser||a()!==e)return console.error("Permission denied. User not authenticated for wishlist subscription"),t([]),()=>{};console.log("Subscribing to wishlist for user:",e);let r=(0,o.doc)(l.db,"wishlists",e);return(0,o.onSnapshot)(r,r=>{r.exists()?t(r.data().items||[]):(console.log("Wishlist document does not exist for user:",e),t([]))},e=>{console.error("Error subscribing to wishlist:",e),e.code&&console.error("Firebase error code:",e.code),t([])})})(t,t=>{e({wishlist:t})});window.wishlistUnsubscribe=s}catch(r){console.error("Error initializing wishlist:",r),h.delete(t),(null==r?void 0:r.code)==="permission-denied"||(null==r?void 0:r.message)&&r.message.includes("Permission denied")?e({error:"Permission denied. Please make sure you are logged in.",loading:!1,wishlist:[]}):e({error:r.message||"Failed to load wishlist",loading:!1})}}},addToWishlist:async t=>{let{user:r}=u.useAuthStore.getState();if(r){if(!r.uid)return void e({error:"User ID not available"});e({loading:!0,error:null});try{await n(r.uid,t),e({loading:!1,error:null})}catch(t){console.error("Error adding to wishlist:",t),(null==t?void 0:t.code)==="permission-denied"||(null==t?void 0:t.message)&&t.message.includes("Permission denied")?e({error:"Permission denied. Please make sure you are logged in.",loading:!1}):e({error:t.message||"Failed to add item to wishlist",loading:!1})}}},removeFromWishlist:async t=>{let{user:r}=u.useAuthStore.getState();if(!r)return void e({error:"Please login to remove items from wishlist"});if(!r.uid)return void e({error:"User ID not available"});e({loading:!0,error:null});try{await d(r.uid,t),e({loading:!1,error:null})}catch(t){console.error("Error removing from wishlist:",t),(null==t?void 0:t.code)==="permission-denied"||(null==t?void 0:t.message)&&t.message.includes("Permission denied")?e({error:"Permission denied. Please make sure you are logged in.",loading:!1}):e({error:t.message||"Failed to remove item from wishlist",loading:!1})}},isInWishlist:e=>{let{wishlist:r}=t();return r.some(t=>t.productId===e)},getWishlistCount:()=>{let{wishlist:e}=t();return e.length}}))},41298:(e,t,r)=>{Promise.resolve().then(r.bind(r,45572))},45572:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>A});var s=r(95155),o=r(12115),l=r(1978),i=r(60760);let a=(0,r(19946).A)("volume-x",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]);var n=r(15273),d=r(51976),c=r(71366),u=r(66516),h=r(62108),m=r(84616),x=r(27809),p=r(42355),g=r(38564),f=r(12486),v=r(68084),w=r(66935),b=r(33681),y=r(29415),j=r(8813),k=r(95997),N=r(6874),C=r.n(N);let P=e=>e>=1e6?(e/1e6).toFixed(1)+"M":e>=1e3?(e/1e3).toFixed(1)+"K":e.toString();function A(){var e,t,r,N,A,E,S;let[T,U]=(0,o.useState)([]),[I,D]=(0,o.useState)(0),[L,F]=(0,o.useState)(!1),[R,M]=(0,o.useState)(!0),[z,H]=(0,o.useState)(!1),[W,_]=(0,o.useState)(!1),[q,Y]=(0,o.useState)(!1),[O,X]=(0,o.useState)(!1),[K,Q]=(0,o.useState)(!1),[V,$]=(0,o.useState)([]),[B,Z]=(0,o.useState)(!1),[G,J]=(0,o.useState)(""),[ee,et]=(0,o.useState)("top"),[er,es]=(0,o.useState)({}),[eo,el]=(0,o.useState)({}),[ei,ea]=(0,o.useState)(new Set),[en,ed]=(0,o.useState)(null),{user:ec}=(0,v.useAuthStore)(),{addToCart:eu}=(0,w.x)(),{addToWishlist:eh,removeFromWishlist:em,isInWishlist:ex}=(0,b.q)(),ep=(0,o.useRef)(null),eg=(0,o.useRef)(null),ef=(0,o.useRef)([]),ev=()=>{if(B)return void Z(!1);if(W)return void _(!1);let e=ef.current[I];e&&(R?(e.pause(),M(!1)):(e.play().catch(console.error),M(!0)))};(0,o.useEffect)(()=>{if(!eg.current)return;let e=0,t=0,r=0,s=0,o=!1,l=t=>{e=t.touches[0].clientY,r=t.touches[0].clientX,o=!1},i=t=>{if(!o){let s=Math.abs(t.touches[0].clientY-e);s>Math.abs(t.touches[0].clientX-r)&&s>10&&(o=!0)}},a=l=>{if(!o)return;t=l.changedTouches[0].clientY,s=l.changedTouches[0].clientX;let i=e-t;!(Math.abs(r-s)>50)&&Math.abs(i)>50&&(i>0?I<T.length-1&&D(e=>{let t=e+1;return setTimeout(()=>{eg.current&&eg.current.scrollTo({top:t*window.innerHeight,behavior:"smooth"})},100),t}):I>0&&D(e=>{let t=e-1;return setTimeout(()=>{eg.current&&eg.current.scrollTo({top:t*window.innerHeight,behavior:"smooth"})},100),t}))},n=eg.current;return n.addEventListener("touchstart",l,{passive:!0}),n.addEventListener("touchmove",i,{passive:!0}),n.addEventListener("touchend",a,{passive:!0}),()=>{n.removeEventListener("touchstart",l),n.removeEventListener("touchmove",i),n.removeEventListener("touchend",a)}},[I,T.length]),(0,o.useEffect)(()=>{let e=e=>{if("ArrowUp"===e.key){if(e.preventDefault(),I>0){let e=I-1;D(e),eg.current&&eg.current.scrollTo({top:e*window.innerHeight,behavior:"smooth"})}}else if("ArrowDown"===e.key){if(e.preventDefault(),I<T.length-1){let e=I+1;D(e),eg.current&&eg.current.scrollTo({top:e*window.innerHeight,behavior:"smooth"})}}else" "===e.key&&(e.preventDefault(),ev())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[I,T.length,ev]),(0,o.useEffect)(()=>{ef.current.forEach((e,t)=>{e&&t!==I&&(e.pause(),e.currentTime=0)});let e=ef.current[I];e&&(e.currentTime=0,e.play().catch(console.error),M(!0))},[I]),(0,o.useEffect)(()=>{console.log("Component mounted, loading reels..."),ew()},[]),(0,o.useEffect)(()=>{if(T.length>0&&T[I]){let e=T[I];Y(eo[e.id]||!1),ec&&(0,y.mQ)(e.id,ec.uid).then(X),Q(!1)}},[I,T,eo,ec]),(0,o.useEffect)(()=>{if(T.length>0&&T[I]){let e=T[I];if(e.id){let t=(0,y.K)(e.id,e=>{console.log("\uD83D\uDCDD Firebase comments loaded:",e.length),console.log("\uD83D\uDCDD Firebase comments data:",e),$(e)});return()=>t()}}},[I,T]);let ew=async()=>{try{console.log("Starting to load reels...");let e=(0,y.H)(e=>{console.log("Received reels from Firebase:",e.length),(async()=>{let t=[];for(let x of e){var r,s,o,l,i,a,n,d,c,u,h,m;let e=null;try{e=await (0,k.gL)(x.userId)}catch(e){console.warn("Failed to fetch user data for reel:",x.id,e)}let p=null;if(x.productId)try{p=await (0,j.oo)(x.productId)}catch(e){console.warn("Failed to fetch product data for reel:",x.id,e)}t.push({...x,id:x.id,product:p||x.product||{},user:{id:x.userId,name:(null==e?void 0:e.name)||(null==(s=x.product)||null==(r=s.seller)?void 0:r.name)||"Unknown User",username:"@".concat((null==e?void 0:e.username)||(null==e||null==(o=e.name)?void 0:o.toLowerCase().replace(/\s+/g,"_"))||(null==(a=x.product)||null==(i=a.seller)||null==(l=i.name)?void 0:l.toLowerCase().replace(/\s+/g,"_"))||"user"),photoURL:(null==e?void 0:e.avatar)||(null==e?void 0:e.profilePic)||(null==(d=x.product)||null==(n=d.seller)?void 0:n.avatar)||(null==(u=x.product)||null==(c=u.seller)?void 0:c.profilePic)||"https://api.dicebear.com/7.x/avataaars/svg?seed=".concat(x.userId),verified:(null==e?void 0:e.isVerified)||(null==(m=x.product)||null==(h=m.seller)?void 0:h.isVerified)||!1},likesCount:x.likesCount||0,commentsCount:x.commentsCount||0,sharesCount:x.sharesCount||0,viewsCount:x.viewsCount||0,duration:x.duration||15,createdAt:x.createdAt||new Date,audio:{name:"Original Audio",artist:"Unknown"}})}U(t),F(!1)})()});return()=>{e&&e()}}catch(e){console.error("Error loading reels:",e),F(!1),U([])}},eb=async()=>{if(!ec)return void alert("Please login to like videos");try{let e=T[I];if(!(null==e?void 0:e.id))return;let t=e.id,r=eo[t]||!1;console.log("Toggling like for reel:",t,"Current state:",r);let s=!r;el(e=>({...e,[t]:s})),Y(s),U(e=>e.map((e,t)=>t===I?{...e,likesCount:s?(e.likesCount||0)+1:Math.max(0,(e.likesCount||0)-1)}:e)),s?(await (0,y.Qk)(t,ec.uid),console.log("✅ Successfully liked reel")):(await (0,y.zT)(t,ec.uid),console.log("✅ Successfully unliked reel"))}catch(t){console.error("❌ Error toggling like:",t);let e=T[I];if(null==e?void 0:e.id){let t=e.id,r=!eo[t];el(e=>({...e,[t]:r})),Y(r),U(e=>e.map((e,t)=>t===I?{...e,likesCount:r?(e.likesCount||0)+1:Math.max(0,(e.likesCount||0)-1)}:e))}alert("Failed to like video. Please try again.")}},ey=async()=>{if(!ec)return void alert("Please login to save videos");try{let e=T[I];if(!(null==e?void 0:e.id))return;let t=e.id;console.log("Toggling save for reel:",t,"Current state:",O),O?(await (0,y.pX)(t,ec.uid),console.log("✅ Successfully unsaved reel"),es(e=>({...e,[t]:Math.max(0,(e[t]||0)-1)}))):(await (0,y.gx)(t,ec.uid),console.log("✅ Successfully saved reel"),es(e=>({...e,[t]:(e[t]||0)+1}))),X(!O)}catch(e){console.error("❌ Error toggling save:",e),alert("Failed to save video. Please try again.")}},ej=async()=>{let e=T[I];if(!(null==e?void 0:e.id))return;let t="".concat(window.location.origin,"/videos?reel=").concat(e.id);try{ec&&(await (0,y.Yn)(e.id,ec.uid),console.log("✅ Successfully shared reel")),U(e=>e.map((e,t)=>t===I?{...e,sharesCount:(e.sharesCount||0)+1}:e)),navigator.share?await navigator.share({title:e.caption||"Check out this video!",text:e.caption,url:t}):(await navigator.clipboard.writeText(t),alert("Link copied to clipboard!"))}catch(e){console.error("❌ Error sharing reel:",e);try{await navigator.clipboard.writeText(t),alert("Link copied to clipboard!")}catch(e){console.error("Failed to copy to clipboard:",e)}}},ek=async e=>{if(e&&(e.preventDefault(),e.stopPropagation()),ec)try{T[I].user.id,Q(!K)}catch(e){console.error("Error toggling follow:",e)}},eN=async()=>{if(ec)try{let e=T[I];e.product&&Object.keys(e.product).length>0&&await eu(e.product,1)}catch(e){console.error("Failed to add to cart:",e)}},eC=async()=>{if(G.trim())try{var e;let t=T[I],r=G.trim(),s={id:"comment-".concat(Date.now()),userId:(null==ec?void 0:ec.uid)||"anonymous",userName:(null==ec?void 0:ec.displayName)||(null==ec||null==(e=ec.email)?void 0:e.split("@")[0])||"Anonymous User",userPhotoURL:null==ec?void 0:ec.photoURL,text:r,createdAt:new Date,likesCount:0};console.log("Adding new comment:",s),console.log("Comment text:",r),console.log("Current user data:",{uid:null==ec?void 0:ec.uid,displayName:null==ec?void 0:ec.displayName,photoURL:null==ec?void 0:ec.photoURL}),$(e=>{let t=[...e,s];return console.log("Updated comments:",t),t}),J(""),ed(null),U(e=>e.map((e,t)=>t===I?{...e,commentsCount:(e.commentsCount||0)+1}:e)),ec&&t.id&&await (0,y.vv)(t.id,ec.uid,ec.displayName||"Anonymous",ec.photoURL||"",r)}catch(e){console.error("Error adding comment:",e)}};if(L)return(0,s.jsx)("div",{className:"min-h-screen bg-black flex items-center justify-center",children:(0,s.jsx)("div",{className:"text-white text-xl",children:"Loading videos..."})});let eP=T[I];return eP?((null==eP?void 0:eP.id)&&er[eP.id],(0,s.jsxs)("div",{className:"videos-page-container fixed inset-0 bg-black",ref:eg,style:{zIndex:30},children:[T.map((e,t)=>(0,s.jsx)("video",{ref:e=>{ef.current[t]=e,t===I&&(ep.current=e)},src:e.videoUrl,className:"full-screen-video",style:{width:"100vw",height:"100vh",objectFit:"cover",position:"absolute",top:0,left:0,display:t===I?"block":"none"},autoPlay:t===I,loop:!0,playsInline:!0,muted:z,onClick:e=>{e.preventDefault(),e.stopPropagation(),ev()}},e.id)),(0,s.jsx)("button",{onClick:()=>{let e=ef.current[I];e&&(e.muted=!z,H(!z),ef.current.forEach(e=>{e&&(e.muted=!z)}))},className:"bg-black/40 rounded-full p-2 backdrop-blur-sm transition-all duration-200",style:{position:"absolute",top:"12px",right:"12px",zIndex:50},children:z?(0,s.jsx)(a,{className:"w-5 h-5 text-white"}):(0,s.jsx)(n.A,{className:"w-5 h-5 text-white"})}),!B&&(0,s.jsxs)("div",{className:"flex flex-col items-center space-y-4",style:{position:"fixed",right:"12px",bottom:"140px",zIndex:50},children:[(0,s.jsxs)(l.P.div,{className:"flex flex-col items-center",whileTap:{scale:.9},children:[(0,s.jsx)(l.P.button,{onClick:eb,className:"p-3 transition-all duration-300",whileTap:{scale:.95},children:(0,s.jsx)(d.A,{className:"w-8 h-8 transition-all duration-300 ".concat(q?"fill-current text-red-500":"fill-current text-white")})}),(0,s.jsx)("span",{className:"text-white text-xs font-bold mt-1 drop-shadow-lg text-center",children:(eP.likesCount||0)>0?P(eP.likesCount||0):""})]}),(0,s.jsxs)(l.P.div,{className:"flex flex-col items-center",whileTap:{scale:.9},children:[(0,s.jsx)(l.P.button,{onClick:()=>{Z(!B)},className:"p-3 transition-all duration-300",whileTap:{scale:.95},children:(0,s.jsx)(c.A,{className:"w-8 h-8 fill-current text-white transition-colors duration-300"})}),(0,s.jsx)("span",{className:"text-white text-xs font-bold mt-1 drop-shadow-lg text-center",children:(eP.commentsCount||0)>0?P(eP.commentsCount||0):""})]}),(0,s.jsxs)(l.P.div,{className:"flex flex-col items-center",whileTap:{scale:.9},children:[(0,s.jsx)(l.P.button,{onClick:ej,className:"p-3 transition-all duration-300",whileTap:{scale:.95},children:(0,s.jsx)(u.A,{className:"w-8 h-8 fill-current text-white transition-colors duration-300"})}),(0,s.jsx)("span",{className:"text-white text-xs font-bold mt-1 drop-shadow-lg text-center",children:(eP.sharesCount||0)>0?P(eP.sharesCount||0):""})]}),(0,s.jsx)(l.P.div,{className:"flex flex-col items-center",whileTap:{scale:.9},children:(0,s.jsx)(l.P.button,{onClick:ey,className:"p-3 transition-all duration-300",whileTap:{scale:.95},children:(0,s.jsx)(h.A,{className:"w-8 h-8 transition-all duration-300 ".concat(O?"fill-current text-yellow-400":"fill-current text-white")})})}),(0,s.jsx)(l.P.div,{className:"mt-2",whileTap:{scale:.9},children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(C(),{href:"/profile/".concat(eP.user.id),children:(0,s.jsx)(l.P.img,{src:eP.user.photoURL,alt:eP.user.name,className:"w-12 h-12 rounded-full border-3 border-white object-cover cursor-pointer shadow-lg",whileHover:{scale:1.1},whileTap:{scale:.95}})}),!K&&(0,s.jsx)(l.P.button,{onClick:e=>ek(e),className:"absolute -bottom-1 -right-1 w-6 h-6 bg-red-500 rounded-full flex items-center justify-center border-2 border-white hover:bg-red-600 transition-colors shadow-lg",whileHover:{scale:1.1},whileTap:{scale:.9},children:(0,s.jsx)(m.A,{className:"w-3 h-3 text-white"})})]})})]}),!B&&(0,s.jsxs)("div",{className:"p-4",style:{position:"fixed",bottom:"80px",left:"0px",right:"80px",zIndex:50,minHeight:"120px"},children:[eP.product&&eP.product.id&&(0,s.jsx)("div",{className:"mb-3 max-w-[120px]",children:(0,s.jsxs)(l.P.div,{whileHover:{scale:1.02},whileTap:{scale:.98},className:"bg-white/90 backdrop-blur-sm rounded-xl p-2 shadow-lg inline-block relative overflow-hidden",children:[(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-purple-50 to-pink-50 opacity-30"}),eP.product.images&&eP.product.images[0]&&(0,s.jsxs)("div",{className:"relative mb-1.5 z-10",children:[(0,s.jsx)(C(),{href:"/product/".concat(eP.product.id),children:(0,s.jsx)("img",{src:eP.product.images[0],alt:eP.product.title,className:"w-full h-16 object-cover rounded-lg hover:scale-105 transition-transform cursor-pointer"})}),(0,s.jsx)("div",{className:"absolute top-0.5 right-0.5 bg-black/50 rounded-full p-0.5",children:(0,s.jsx)(x.A,{className:"w-2 h-2 text-white"})})]}),(0,s.jsxs)("div",{className:"text-center relative z-10",children:[(0,s.jsx)("div",{className:"mb-1.5",children:(0,s.jsxs)("span",{className:"text-sm font-bold text-purple-600",children:["$",null==(e=eP.product.price)?void 0:e.toFixed(0)]})}),(0,s.jsxs)("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),eN()},className:"w-full bg-gradient-to-r from-purple-600 to-pink-600 text-white text-xs py-1.5 px-2 rounded-lg hover:from-purple-700 hover:to-pink-700 transition-all duration-200 flex items-center justify-center space-x-1 shadow-md hover:shadow-lg transform hover:scale-105",children:[(0,s.jsx)(x.A,{className:"w-2.5 h-2.5"}),(0,s.jsx)("span",{className:"font-medium",children:"Add"})]})]})]})}),(0,s.jsxs)("div",{className:"flex items-center space-x-3 mb-3",children:[(0,s.jsx)("img",{src:eP.user.photoURL,alt:eP.user.name,className:"w-8 h-8 rounded-full border-2 border-white object-cover"}),(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),window.location.href="/profile/".concat(eP.user.id)},className:"text-white font-bold text-base drop-shadow-lg hover:text-purple-300 transition-colors cursor-pointer",children:eP.user.name}),eP.user.verified&&(0,s.jsx)("div",{className:"w-4 h-4 bg-blue-500 rounded-full flex items-center justify-center",children:(0,s.jsx)("svg",{className:"w-2.5 h-2.5 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})})]}),!K&&(0,s.jsx)("button",{onClick:e=>ek(e),className:"ml-auto bg-white text-black px-4 py-1 rounded-lg text-sm font-semibold hover:bg-gray-200 transition-colors",children:"Follow"})]}),(0,s.jsx)("div",{className:"mb-2",children:(0,s.jsxs)("p",{className:"text-white text-sm drop-shadow-lg leading-relaxed",children:[(0,s.jsx)("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),window.location.href="/profile/".concat(eP.user.id)},className:"font-semibold hover:text-purple-300 transition-colors cursor-pointer",children:eP.user.username})," ",eP.caption]})})]}),(0,s.jsx)(i.N,{children:W&&eP.product&&eP.product.title&&(0,s.jsxs)(l.P.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",damping:20},className:"absolute top-0 right-0 bottom-0 w-4/5 bg-white dark:bg-gray-900 rounded-l-3xl shadow-2xl p-6 overflow-y-auto z-30",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,s.jsx)("h2",{className:"text-xl font-bold",children:"Product Details"}),(0,s.jsx)("button",{onClick:()=>_(!1),className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800",children:(0,s.jsx)(p.A,{className:"w-6 h-6"})})]}),eP.product.images&&eP.product.images[0]&&(0,s.jsx)("img",{src:eP.product.images[0],alt:eP.product.title||"Product image",className:"w-full h-64 object-cover rounded-xl mb-4"}),(0,s.jsx)("h3",{className:"text-2xl font-bold mb-2",children:eP.product.title}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-300 mb-4",children:eP.product.description}),(0,s.jsxs)("div",{className:"flex items-center mb-4",children:[(0,s.jsx)("div",{className:"flex",children:[void 0,void 0,void 0,void 0,void 0].map((e,t)=>{var r;return(0,s.jsx)(g.A,{className:"w-4 h-4 ".concat(t<Math.floor((null==(r=eP.product)?void 0:r.rating)||0)?"text-yellow-400 fill-current":"text-gray-300")},t)})}),(0,s.jsxs)("span",{className:"ml-2 text-sm text-gray-500",children:["(",eP.product.rating||0,")"]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,s.jsxs)("span",{className:"text-2xl font-bold text-purple-600",children:["$",null==(t=eP.product.price)?void 0:t.toFixed(2)]}),eP.product.originalPrice&&(0,s.jsxs)("span",{className:"text-lg text-gray-500 line-through",children:["$",eP.product.originalPrice.toFixed(2)]})]}),(0,s.jsxs)("div",{className:"flex space-x-3",children:[(0,s.jsxs)("button",{onClick:eN,className:"flex-1 bg-purple-600 text-white py-3 rounded-xl font-semibold flex items-center justify-center",children:[(0,s.jsx)(x.A,{className:"w-5 h-5 mr-2"}),"Add to Cart"]}),(0,s.jsx)("button",{onClick:()=>{var e;(null==(e=eP.product)?void 0:e.id)&&(ex(eP.product.id)?em(eP.product.id):eh(eP.product))},className:"p-3 bg-gray-100 dark:bg-gray-800 rounded-xl",children:(0,s.jsx)(h.A,{className:"w-6 h-6 ".concat((null==(r=eP.product)?void 0:r.id)&&ex(eP.product.id)?"fill-current text-purple-600":"text-gray-600 dark:text-gray-300")})})]})]})}),(0,s.jsx)(i.N,{children:B&&(0,s.jsxs)(l.P.div,{initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:20},className:"absolute inset-x-0 bottom-0 h-2/3 bg-white dark:bg-gray-900 rounded-t-3xl shadow-2xl p-6 flex flex-col z-50",onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,s.jsxs)("h2",{className:"text-xl font-bold",children:["Comments (",V.length,")"]}),(0,s.jsx)("button",{onClick:()=>Z(!1),className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800",children:(0,s.jsx)(p.A,{className:"w-6 h-6"})})]}),(0,s.jsxs)("div",{className:"flex space-x-1 mb-4 bg-gray-100 dark:bg-gray-800 rounded-full p-1",children:[(0,s.jsx)("button",{onClick:()=>et("top"),className:"flex-1 py-2 px-4 rounded-full text-sm font-medium transition-all duration-200 ".concat("top"===ee?"bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"),children:"Top"}),(0,s.jsx)("button",{onClick:()=>et("new"),className:"flex-1 py-2 px-4 rounded-full text-sm font-medium transition-all duration-200 ".concat("new"===ee?"bg-white dark:bg-gray-700 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"),children:"Newest"})]}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto mb-4 comments-scroll",children:0===V.length?(0,s.jsxs)("div",{className:"text-center text-gray-500 py-8",children:[(0,s.jsx)("p",{children:"No comments yet. Be the first to comment!"}),(0,s.jsxs)("p",{className:"text-xs mt-2",children:["Debug: Comments array length: ",V.length]})]}):V.sort((e,t)=>"top"===ee?(t.likesCount||0)-(e.likesCount||0):new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()).map(e=>{var t,r;return(0,s.jsxs)("div",{className:"flex items-start space-x-3 mb-4",children:[(0,s.jsx)("button",{onClick:t=>{t.preventDefault(),t.stopPropagation(),console.log("Navigating to profile:",e.userId,"Comment author:",e.userName),e.userId&&"anonymous"!==e.userId&&window.open("/profile/".concat(e.userId),"_blank")},className:"flex-shrink-0",children:e.userPhotoURL?(0,s.jsx)("img",{src:e.userPhotoURL,alt:e.userName,className:"w-8 h-8 rounded-full object-cover hover:ring-2 hover:ring-purple-500 transition-all duration-200",onError:e=>{e.currentTarget.style.display="none"}}):(0,s.jsx)("div",{className:"w-8 h-8 rounded-full bg-gray-300 flex items-center justify-center text-gray-600 text-xs font-bold",children:(null==(r=e.userName)||null==(t=r.charAt(0))?void 0:t.toUpperCase())||"?"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("div",{className:"bg-gray-100 dark:bg-gray-800 rounded-2xl px-4 py-2",children:(0,s.jsxs)("p",{className:"text-sm break-words text-gray-900 dark:text-white",children:[(0,s.jsx)("button",{onClick:t=>{t.preventDefault(),t.stopPropagation(),console.log("Username clicked - Navigating to profile:",e.userId,"Comment author:",e.userName),e.userId&&"anonymous"!==e.userId&&window.open("/profile/".concat(e.userId),"_blank")},className:"font-semibold hover:text-purple-600 dark:hover:text-purple-400 transition-colors mr-2 text-gray-900 dark:text-white",children:e.userName}),(0,s.jsx)("span",{className:"text-gray-900 dark:text-white",children:e.text||"No text"})]})}),(0,s.jsxs)("div",{className:"flex items-center space-x-3 mt-1 text-xs text-gray-500",children:[(0,s.jsx)("span",{children:(e=>{let t=new Date,r=e instanceof Date?e:new Date(e),s=Math.floor((t.getTime()-r.getTime())/1e3);return s<60?"".concat(s,"s"):s<3600?"".concat(Math.floor(s/60),"m"):s<86400?"".concat(Math.floor(s/3600),"h"):s<604800?"".concat(Math.floor(s/86400),"d"):"".concat(Math.floor(s/604800),"w")})(e.createdAt)}),(0,s.jsx)("button",{onClick:()=>{var t,r;return t=e.id,r=e.userName,void(ed(t),J("@".concat(r," ")))},className:"font-semibold hover:text-gray-700 dark:hover:text-gray-300 transition-colors",children:"Reply"}),(0,s.jsxs)("button",{onClick:()=>{var t;return t=e.id,void ea(e=>{let r=new Set(e);return r.has(t)?(r.delete(t),$(e=>e.map(e=>e.id===t?{...e,likesCount:Math.max(0,(e.likesCount||0)-1)}:e))):(r.add(t),$(e=>e.map(e=>e.id===t?{...e,likesCount:(e.likesCount||0)+1}:e))),r})},className:"font-semibold hover:text-gray-700 dark:hover:text-gray-300 flex items-center space-x-1 transition-colors ".concat(ei.has(e.id)?"text-red-500":""),children:[(0,s.jsx)(d.A,{className:"w-3 h-3 transition-all duration-200 ".concat(ei.has(e.id)?"fill-current text-red-500":"")}),(0,s.jsx)("span",{children:e.likesCount||0})]})]})]})]},e.id)})}),(0,s.jsxs)("div",{className:"pt-4 border-t border-gray-200 dark:border-gray-800 bg-white dark:bg-gray-900",children:[en&&(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2 p-2 bg-blue-50 dark:bg-blue-900/20 rounded-lg",children:[(0,s.jsxs)("span",{className:"text-sm text-blue-600 dark:text-blue-400",children:["Replying to ",G.split(" ")[0]]}),(0,s.jsx)("button",{onClick:()=>{ed(null),J("")},className:"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300",children:"✕"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-3 mb-3",children:[(0,s.jsx)("button",{onClick:()=>{(null==ec?void 0:ec.uid)&&(window.location.href="/profile/".concat(ec.uid))},className:"flex-shrink-0",children:(null==ec?void 0:ec.photoURL)?(0,s.jsx)("img",{src:ec.photoURL,alt:"Your profile",className:"w-10 h-10 rounded-full object-cover border-2 border-gray-200 dark:border-gray-700 hover:border-purple-500 transition-all duration-200"}):(0,s.jsx)("div",{className:"w-10 h-10 rounded-full bg-purple-500 flex items-center justify-center text-white text-sm font-bold border-2 border-gray-200 dark:border-gray-700",children:(null==ec||null==(A=ec.displayName)||null==(N=A.charAt(0))?void 0:N.toUpperCase())||(null==ec||null==(S=ec.email)||null==(E=S.charAt(0))?void 0:E.toUpperCase())||"?"})}),(0,s.jsxs)("div",{className:"flex-1 relative",children:[(0,s.jsx)("input",{type:"text",value:G||"",onChange:e=>J(e.target.value),placeholder:en?"Write a reply...":"Add a comment...",className:"w-full bg-gray-100 dark:bg-gray-800 rounded-full px-4 py-3 pr-24 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:bg-white dark:focus:bg-gray-700 transition-all duration-200",onKeyPress:e=>{"Enter"===e.key&&G.trim()&&eC()}}),(0,s.jsxs)("div",{className:"absolute right-2 top-1/2 transform -translate-y-1/2 flex items-center space-x-1",children:[(0,s.jsx)("button",{onClick:()=>J(e=>e+"❤️"),className:"p-1.5 rounded-full hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors",title:"Add heart emoji",children:(0,s.jsx)("span",{className:"text-lg",children:"\uD83D\uDE0A"})}),(0,s.jsx)("button",{onClick:eC,disabled:!G.trim(),className:"p-1.5 rounded-full transition-all duration-200 ".concat(G.trim()?"bg-purple-600 text-white hover:bg-purple-700 scale-100":"text-gray-400 cursor-not-allowed scale-90"),children:(0,s.jsx)(f.A,{className:"w-4 h-4"})})]})]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-2 px-2",children:[(0,s.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400 font-medium",children:"Quick reactions:"}),["❤️","\uD83D\uDE02","\uD83D\uDE0D","\uD83D\uDD25","\uD83D\uDC4F","\uD83D\uDCAF"].map(e=>(0,s.jsx)("button",{onClick:()=>J(t=>t+e),className:"p-2 rounded-full hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-lg",children:e},e))]})]})]})})]})):(0,s.jsx)("div",{className:"min-h-screen bg-black"})}},62108:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(19946).A)("bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]])}},e=>{e.O(0,[2992,9507,1794,6899,8599,7194,6874,2939,6935,4978,8441,5964,7358],()=>e(e.s=41298)),_N_E=e.O()}]);