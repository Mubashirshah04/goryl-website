(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4029,5610],{6115:(e,r,t)=>{"use strict";var a=t(12115),o=t(49033),l="function"==typeof Object.is?Object.is:function(e,r){return e===r&&(0!==e||1/e==1/r)||e!=e&&r!=r},s=o.useSyncExternalStore,n=a.useRef,i=a.useEffect,c=a.useMemo,u=a.useDebugValue;r.useSyncExternalStoreWithSelector=function(e,r,t,a,o){var d=n(null);if(null===d.current){var f={hasValue:!1,value:null};d.current=f}else f=d.current;var m=s(e,(d=c(function(){function e(e){if(!i){if(i=!0,s=e,e=a(e),void 0!==o&&f.hasValue){var r=f.value;if(o(r,e))return n=r}return n=e}if(r=n,l(s,e))return r;var t=a(e);return void 0!==o&&o(r,t)?(s=e,r):(s=e,n=t)}var s,n,i=!1,c=void 0===t?null:t;return[function(){return e(r())},null===c?void 0:function(){return e(c())}]},[r,t,a,o]))[0],d[1]);return i(function(){f.hasValue=!0,f.value=m},[m]),u(m),m}},19946:(e,r,t)=>{"use strict";t.d(r,{A:()=>i});var a=t(12115);let o=e=>{let r=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,t)=>t?t.toUpperCase():r.toLowerCase());return r.charAt(0).toUpperCase()+r.slice(1)},l=function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return r.filter((e,r,t)=>!!e&&""!==e.trim()&&t.indexOf(e)===r).join(" ").trim()};var s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let n=(0,a.forwardRef)((e,r)=>{let{color:t="currentColor",size:o=24,strokeWidth:n=2,absoluteStrokeWidth:i,className:c="",children:u,iconNode:d,...f}=e;return(0,a.createElement)("svg",{ref:r,...s,width:o,height:o,stroke:t,strokeWidth:i?24*Number(n)/Number(o):n,className:l("lucide",c),...!u&&!(e=>{for(let r in e)if(r.startsWith("aria-")||"role"===r||"title"===r)return!0})(f)&&{"aria-hidden":"true"},...f},[...d.map(e=>{let[r,t]=e;return(0,a.createElement)(r,t)}),...Array.isArray(u)?u:[u]])}),i=(e,r)=>{let t=(0,a.forwardRef)((t,s)=>{let{className:i,...c}=t;return(0,a.createElement)(n,{ref:s,iconNode:r,className:l("lucide-".concat(o(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),i),...c})});return t.displayName=o(e),t}},22436:(e,r,t)=>{"use strict";var a=t(12115),o="function"==typeof Object.is?Object.is:function(e,r){return e===r&&(0!==e||1/e==1/r)||e!=e&&r!=r},l=a.useState,s=a.useEffect,n=a.useLayoutEffect,i=a.useDebugValue;function c(e){var r=e.getSnapshot;e=e.value;try{var t=r();return!o(e,t)}catch(e){return!0}}var u="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,r){return r()}:function(e,r){var t=r(),a=l({inst:{value:t,getSnapshot:r}}),o=a[0].inst,u=a[1];return n(function(){o.value=t,o.getSnapshot=r,c(o)&&u({inst:o})},[e,t,r]),s(function(){return c(o)&&u({inst:o}),e(function(){c(o)&&u({inst:o})})},[e]),i(t),t};r.useSyncExternalStore=void 0!==a.useSyncExternalStore?a.useSyncExternalStore:u},25610:(e,r,t)=>{"use strict";t.d(r,{db:()=>f,j2:()=>d,storage:()=>m});var a=t(23915),o=t(16203),l=t(35317),s=t(90858),n=t(92144),i=t(81115),c=t(86864);let u=(0,a.Wp)({apiKey:"AIzaSyByhCgo_k9i8_AstSaZkZ3Atv5Rt2eOjhc",authDomain:"zaillisy.firebaseapp.com",databaseURL:"https://zaillisy-default-rtdb.firebaseio.com",projectId:"zaillisy",storageBucket:"zaillisy.firebasestorage.app",messagingSenderId:"984913226421",appId:"1:984913226421:web:c648bbccdd5055cf6cecfc",measurementId:"G-95WJ280TC9"}),d=(0,o.xI)(u),f=(0,l.aU)(u);(0,i.C3)(u);let m=(0,s.c7)(u);(0,n.Uz)(u);try{(0,c.TT)().then(e=>{e?((0,c.P5)(u),console.log("\uD83D\uDCCA Firebase Analytics enabled")):console.log("ℹ️ Firebase Analytics not supported in this environment")}).catch(()=>{console.warn("Analytics check failed; continuing without Analytics")})}catch(e){console.warn("Analytics initialization skipped:",e)}console.log("\uD83D\uDE80 Using production Firebase configuration for project:",u.options.projectId)},35169:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=(0,t(19946).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},35695:(e,r,t)=>{"use strict";var a=t(18999);t.o(a,"useParams")&&t.d(r,{useParams:function(){return a.useParams}}),t.o(a,"usePathname")&&t.d(r,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(r,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(r,{useSearchParams:function(){return a.useSearchParams}})},45643:(e,r,t)=>{"use strict";e.exports=t(6115)},47439:(e,r,t)=>{"use strict";t.d(r,{QM:()=>l,V6:()=>s,nJ:()=>n});var a=t(25610),o=t(90858);let l=async(e,r,t)=>{console.log("=== FIREBASE UPLOAD DEBUG START ==="),console.log("Starting file upload..."),console.log("File:",e.name,"Size:",e.size,"Type:",e.type),console.log("Upload path:",r),console.log("Firebase storage initialized:",!!a.storage),console.log("=========================");try{if(!a.storage)throw Error("Firebase storage not initialized");let l=(0,o.ref)(a.storage,r),s=(0,o.bp)(l,e);return new Promise((a,l)=>{s.on("state_changed",e=>{let r=e.bytesTransferred/e.totalBytes*100;console.log("Upload is "+r+"% done"),t&&t(r)},e=>{console.error("Firebase upload error:",e),l(e)},async()=>{try{let t=await (0,o.getDownloadURL)(s.snapshot.ref);console.log("File available at",t),a({url:t,path:r,name:e.name})}catch(e){console.error("Error getting download URL:",e),l(e)}})})}catch(t){return console.error("Error uploading file:",t),console.error("Full error details:",JSON.stringify(t,null,2)),{url:"https://via.placeholder.com/400x400/6366f1/ffffff?text=".concat(encodeURIComponent(e.name)),path:r,name:e.name}}},s=async function(e,r){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"products",a=arguments.length>3?arguments[3]:void 0,o=Date.now(),s="".concat(o,"_").concat(e.name);return l(e,"".concat(t,"/").concat(r,"/").concat(s),a)},n=function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0xa00000,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:["image/jpeg","image/png","image/webp","video/mp4","video/mov"];return e.size>r?{valid:!1,error:"File size must be less than ".concat(Math.round(r/1024/1024),"MB")}:t.includes(e.type)?{valid:!0}:{valid:!1,error:"File type not allowed. Allowed types: ".concat(t.join(", "))}}},49033:(e,r,t)=>{"use strict";e.exports=t(22436)},55163:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>m});var a=t(95155),o=t(12115),l=t(35695),s=t(35169),n=t(71007),i=t(84355),c=t(68084),u=t(98868),d=t(47439),f=t(56671);function m(){let e=(0,l.useRouter)(),{user:r}=(0,c.useAuthStore)(),{profile:t,fetchProfile:m,updateProfile:p}=(0,u.n)(),[g,h]=(0,o.useState)(!1),[b,y]=(0,o.useState)(!1),[v,w]=(0,o.useState)({name:"",bio:"",about:"",phone:"",email:"",photoURL:"",username:""}),[x,j]=(0,o.useState)(null);(0,o.useEffect)(()=>{(null==r?void 0:r.uid)&&m(r.uid)},[null==r?void 0:r.uid]),(0,o.useEffect)(()=>{if(t){let e="";t.customPhotoURL?e=t.customPhotoURL:t.photoURL?e=t.photoURL:t.profilePic?e=t.profilePic:t.avatar&&(e=t.avatar),w({name:t.name||"",bio:t.bio||"",about:t.about||"",phone:t.phone||"",email:t.email||"",photoURL:e,username:t.username||""}),t.usernameLastChanged&&j(new Date(t.usernameLastChanged))}},[t]),(0,o.useEffect)(()=>{r||e.push("/login")},[r,e]);let N=(e,r)=>{w(t=>({...t,[e]:r}))},A=async e=>{var t;let a=null==(t=e.target.files)?void 0:t[0];if(a&&(null==r?void 0:r.uid)){if(!a.type.startsWith("image/"))return void f.oR.error("Please select a valid image file");if(a.size>5242880)return void f.oR.error("Image size must be less than 5MB");y(!0);try{console.log("Starting image upload...",{fileName:a.name,fileSize:a.size});try{let e=await (0,d.QM)(a,"profile-images/".concat(r.uid,"/").concat(a.name));console.log("Upload completed, download URL obtained:",e.url),w(r=>({...r,photoURL:e.url})),f.oR.success("Profile picture updated successfully");return}catch(e){throw console.warn("Firebase Storage upload failed, trying fallback:",e),e}}catch(e){console.error("Error uploading image:",e);try{let e=new FileReader;e.onload=e=>{var r;let t=null==(r=e.target)?void 0:r.result;w(e=>({...e,photoURL:t})),f.oR.success("Profile picture updated (local preview)")},e.readAsDataURL(a)}catch(r){console.error("Fallback also failed:",r),e instanceof Error?e.message.includes("storage/unauthorized")?f.oR.error("Upload failed: Unauthorized. Please check your permissions."):e.message.includes("storage/quota-exceeded")?f.oR.error("Upload failed: Storage quota exceeded."):e.message.includes("storage/network-request-failed")?f.oR.error("Upload failed: Network error. Please check your connection."):f.oR.error("Upload failed: ".concat(e.message)):f.oR.error("Failed to upload image. Please try again.")}}finally{y(!1),e.target.value=""}}},S=async()=>{if(r){h(!0);try{await p(r.uid,{name:v.name,bio:v.bio,about:v.about,phone:v.phone,photoURL:v.photoURL,customPhotoURL:v.photoURL,username:v.username}),f.oR.success("Profile updated successfully"),e.push("/profile/".concat(r.uid))}catch(e){console.error("Error updating profile:",e),f.oR.error(e.message||"Failed to update profile")}finally{h(!1)}}},E=()=>{e.back()};if(!r)return(0,a.jsx)("div",{className:"min-h-screen bg-white flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Please Log In"}),(0,a.jsx)("p",{className:"text-gray-600",children:"You need to be logged in to edit your profile."})]})});if(!t)return(0,a.jsx)("div",{className:"min-h-screen bg-white flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Loading profile..."})]})});let U=[{id:"avatar1",name:"Avatar 1",url:"https://api.dicebear.com/7.x/avataaars/svg?seed=Avatar1&backgroundColor=ffdfbf&eyebrow=raisedExcitedNatural,upMale2,frownMale2"},{id:"avatar2",name:"Avatar 2",url:"https://api.dicebear.com/7.x/avataaars/svg?seed=Avatar2&backgroundColor=d1d4f9&eyebrow=raisedExcited,frownFemale2,upFemale2"},{id:"avatar3",name:"Avatar 3",url:"https://api.dicebear.com/7.x/avataaars/svg?seed=Avatar3&backgroundColor=c0aede&eyebrow=raisedExcitedNatural,upMale2,frownMale2&eyes=squint,surprised,wink"},{id:"avatar4",name:"Avatar 4",url:"https://api.dicebear.com/7.x/avataaars/svg?seed=Avatar4&backgroundColor=ffd5dc&eyebrow=raisedExcited,frownFemale2,upFemale2&eyes=eyeRoll,surprised,wink"},{id:"avatar5",name:"Avatar 5",url:"https://api.dicebear.com/7.x/avataaars/svg?seed=Avatar5&backgroundColor=a0d2eb&eyebrow=raisedExcitedNatural,upMale2,frownMale2&eyes=default,squint,surprised"},{id:"avatar6",name:"Avatar 6",url:"https://api.dicebear.com/7.x/avataaars/svg?seed=Avatar6&backgroundColor=ffb6c1&eyebrow=raisedExcited,frownFemale2,upFemale2&eyes=eyeRoll,default,wink"}];return(0,o.useEffect)(()=>{console.log("Default avatars available:",U.length),U.forEach((e,r)=>{let t=new Image;t.onload=()=>{console.log("Avatar ".concat(r+1," loaded successfully:"),e.name)},t.onerror=()=>{console.error("Failed to load avatar ".concat(r+1,":"),e.name,e.url)},t.src=e.url})},[]),(0,a.jsxs)("div",{className:"min-h-screen bg-white",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border-b",children:[(0,a.jsx)("button",{onClick:E,className:"p-2",children:(0,a.jsx)(s.A,{className:"w-6 h-6"})}),(0,a.jsx)("h1",{className:"text-lg font-semibold",children:"Edit Profile"}),(0,a.jsx)("div",{className:"w-10"})," "]}),(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),S()},className:"p-4",children:[(0,a.jsxs)("div",{className:"flex flex-col items-center mb-6",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"w-24 h-24 rounded-full overflow-hidden bg-gray-200",children:v.photoURL?(0,a.jsx)("img",{src:v.photoURL,alt:"Profile",width:"96",height:"96",className:"w-full h-full object-cover"}):(0,a.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,a.jsx)(n.A,{className:"w-12 h-12 text-gray-400"})})}),(0,a.jsx)("label",{htmlFor:"photo-upload",className:"absolute bottom-0 right-0 bg-purple-600 rounded-full p-2 cursor-pointer",children:(0,a.jsx)(i.A,{className:"w-4 h-4 text-white"})}),(0,a.jsx)("input",{id:"photo-upload",type:"file",accept:"image/*",onChange:A,className:"hidden",disabled:b})]}),b&&(0,a.jsx)("div",{className:"mt-2 text-sm text-purple-600",children:"Uploading..."})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h3",{className:"text-sm font-medium text-gray-700 mb-3",children:"Or choose a default avatar:"}),(0,a.jsx)("div",{className:"grid grid-cols-3 sm:grid-cols-6 gap-3",children:U.map(e=>(0,a.jsx)("button",{type:"button",onClick:()=>{var r;console.log("Selecting default avatar:",r=e.url),w(e=>({...e,photoURL:r})),f.oR.success("Default avatar selected")},className:"rounded-lg overflow-hidden border-2 transition-all transform hover:scale-105 ".concat(v.photoURL===e.url?"border-purple-500 ring-2 ring-purple-200":"border-gray-200 hover:border-purple-300"),title:e.name,children:(0,a.jsx)("img",{src:e.url,alt:e.name,className:"w-full h-20 object-cover",onError:r=>{console.error("Failed to load avatar:",e.url),r.currentTarget.src="https://api.dicebear.com/7.x/avataaars/svg?seed=Default"},onLoad:()=>{console.log("Avatar loaded successfully:",e.name,e.url)}})},e.id))}),(0,a.jsxs)("div",{className:"mt-2 text-xs text-gray-500",children:["Selected avatar: ",v.photoURL||"None"]})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)("span",{className:"text-gray-500",children:"@"})}),(0,a.jsx)("input",{type:"text",id:"username",value:v.username,onChange:e=>N("username",e.target.value),className:"block w-full pl-8 pr-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-purple-500 focus:border-purple-500",placeholder:"yourusername",disabled:!!(null==t?void 0:t.username)&&!!x&&v.username!==t.username&&30>Math.floor((new Date().getTime()-x.getTime())/864e5)})]}),x&&(0,a.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:(()=>{if(!x)return"Your username must be unique. You can change it once every 30 days.";let e=Math.floor((new Date().getTime()-x.getTime())/864e5);if(e>=30)return"You can change your username now.";{let r=30-e;return"You can change your username again in ".concat(r," day").concat(1!==r?"s":"",".")}})()}),!x&&(0,a.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Your username must be unique. You can change it once every 30 days."})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Name"}),(0,a.jsx)("input",{type:"text",id:"name",value:v.name,onChange:e=>N("name",e.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-purple-500 focus:border-purple-500",placeholder:"Your name"})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{htmlFor:"bio",className:"block text-sm font-medium text-gray-700 mb-1",children:"Bio (Short Description)"}),(0,a.jsx)("textarea",{id:"bio",rows:2,value:v.bio,onChange:e=>N("bio",e.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-purple-500 focus:border-purple-500",placeholder:"A short description about yourself"})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{htmlFor:"about",className:"block text-sm font-medium text-gray-700 mb-1",children:"About (Detailed Description)"}),(0,a.jsx)("textarea",{id:"about",rows:4,value:v.about,onChange:e=>N("about",e.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-purple-500 focus:border-purple-500",placeholder:"A detailed description about yourself"})]}),(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),(0,a.jsx)("input",{type:"tel",id:"phone",value:v.phone,onChange:e=>N("phone",e.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-purple-500 focus:border-purple-500",placeholder:"Your phone number"})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),(0,a.jsx)("input",{type:"email",id:"email",value:v.email,readOnly:!0,className:"block w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-500",placeholder:"Your email"})]}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)("button",{type:"button",onClick:E,className:"flex-1 px-4 py-2 border border-gray-300 text-sm font-medium rounded-lg text-gray-700 bg-white hover:bg-gray-50",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:g,className:"flex-1 px-4 py-2 border border-transparent text-sm font-medium rounded-lg text-white bg-purple-600 hover:bg-purple-700 disabled:opacity-50",children:g?"Saving...":"Save"})]})]})]})}},68084:(e,r,t)=>{"use strict";t.d(r,{useAuthStore:()=>n});var a=t(88693),o=t(16203),l=t(25610),s=t(95997);let n=(0,a.vt)((e,r)=>({user:null,userData:null,loading:!0,unsubscribeUserListener:null,setUser:r=>e({user:r}),setUserData:r=>e({userData:r}),setLoading:r=>e({loading:r}),setUnsubscribeUserListener:r=>e({unsubscribeUserListener:r}),initialize:()=>(0,o.hg)(l.j2,async a=>{if(a)try{let o=await (0,s.gL)(a.uid),l=Object.assign(Object.assign({},a),{role:null==o?void 0:o.role});e({user:l,userData:o,loading:!1});let{doc:n,onSnapshot:i}=await Promise.resolve().then(t.bind(t,35317)),{db:c}=await Promise.resolve().then(t.bind(t,25610)),u=n(c,"users",a.uid),d=i(u,t=>{if(t.exists()){let a=t.data();e({userData:a,user:Object.assign(Object.assign({},r().user||{}),{role:a.role})})}});e({unsubscribeUserListener:d})}catch(r){console.error("Error fetching user data:",r),e({user:Object.assign(Object.assign({},a),{role:void 0}),userData:null,loading:!1})}else{let{unsubscribeUserListener:t}=r();t&&(t(),e({unsubscribeUserListener:null})),e({user:null,userData:null,loading:!1})}}),refreshUserData:async()=>{let{user:t}=r();if(t)try{let a=await (0,s.gL)(t.uid);e({userData:a,user:Object.assign(Object.assign({},r().user||{}),{role:null==a?void 0:a.role})}),setTimeout(async()=>{try{let a=await (0,s.gL)(t.uid);e({userData:a,user:Object.assign(Object.assign({},r().user||{}),{role:null==a?void 0:a.role})})}catch(e){console.warn("Error in delayed refresh:",e)}},500)}catch(e){console.error("Error refreshing user data:",e)}}}));setTimeout(()=>{n.getState().initialize()},0)},71007:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=(0,t(19946).A)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},84355:(e,r,t)=>{"use strict";t.d(r,{A:()=>a});let a=(0,t(19946).A)("camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]])},88693:(e,r,t)=>{"use strict";t.d(r,{vt:()=>u});let a=e=>{let r,t=new Set,a=(e,a)=>{let o="function"==typeof e?e(r):e;if(!Object.is(o,r)){let e=r;r=(null!=a?a:"object"!=typeof o||null===o)?o:Object.assign({},r,o),t.forEach(t=>t(r,e))}},o=()=>r,l={setState:a,getState:o,getInitialState:()=>s,subscribe:e=>(t.add(e),()=>t.delete(e)),destroy:()=>{console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},s=r=e(a,o,l);return l};var o=t(12115),l=t(45643);let{useDebugValue:s}=o,{useSyncExternalStoreWithSelector:n}=l,i=!1,c=e=>{"function"!=typeof e&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");let r="function"==typeof e?(e=>e?a(e):a)(e):e,t=(e,t)=>(function(e,r=e=>e,t){t&&!i&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),i=!0);let a=n(e.subscribe,e.getState,e.getServerState||e.getInitialState,r,t);return s(a),a})(r,e,t);return Object.assign(t,r),t},u=e=>e?c(e):c},89095:(e,r,t)=>{Promise.resolve().then(t.bind(t,55163))},95997:(e,r,t)=>{"use strict";t.d(r,{G6:()=>n,HW:()=>d,Hh:()=>c,Jv:()=>i,eT:()=>h,gL:()=>f,qc:()=>g,xw:()=>u});var a=t(16203),o=t(35317),l=t(25610);let s=new a.HF;s.addScope("email"),s.addScope("profile");let n=async()=>{var e;try{let r=(await (0,a.df)(l.j2,s)).user;if(!(await (0,o.x7)((0,o.doc)(l.db,"users",r.uid))).exists()){let t={id:r.uid,email:r.email||"",name:r.displayName||"Anonymous",username:(null==(e=r.email)?void 0:e.split("@")[0])||"user",avatar:r.photoURL||"",role:"user",accountType:"user",isVerified:!1,isVerifiedSeller:!1,isActive:!0,createdAt:new Date,updatedAt:new Date,followersCount:0,followingCount:0,productsCount:0,rating:0,totalSales:0};await (0,o.BN)((0,o.doc)(l.db,"users",r.uid),t)}return r}catch(e){throw console.error("Google sign-in error:",e),e}},i=async(e,r)=>{try{return(await (0,a.x9)(l.j2,e,r)).user}catch(e){throw e}},c=async function(e,r,t){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"user";try{let n=(await (0,a.eJ)(l.j2,e,r)).user;await (0,a.r7)(n,{displayName:t});try{let r={id:n.uid,email:n.email||"",name:t,username:e.split("@")[0],avatar:n.photoURL||"",bio:"",role:s,accountType:s,isVerified:!1,isVerifiedSeller:!1,isActive:!0,createdAt:new Date,updatedAt:new Date,followersCount:0,followingCount:0,productsCount:0,rating:0,totalSales:0};await (0,o.BN)((0,o.doc)(l.db,"users",n.uid),r),console.log("✅ User profile created successfully")}catch(e){console.warn("Could not create user document in Firestore:",e)}return n}catch(e){throw console.error("Signup error:",e),e}},u=async e=>{try{await (0,a.J1)(l.j2,e)}catch(e){throw e}},d=()=>l.j2.currentUser,f=async e=>{try{let r=await (0,o.x7)((0,o.doc)(l.db,"users",e));if(r.exists())return r.data();return null}catch(e){return console.error("Error getting user data:",e),null}},m=async e=>{try{let r=await f(e);return(null==r?void 0:r.role)||"user"}catch(e){return console.error("Error checking user role:",e),"user"}},p=async e=>{try{let r=await f(e);return(null==r?void 0:r.accountType)||"user"}catch(e){return console.error("Error checking account type:",e),"user"}},g=async e=>"admin"===await m(e),h=async e=>["personal_seller","brand","company"].includes(await p(e))},98868:(e,r,t)=>{"use strict";t.d(r,{n:()=>i});var a=t(88693),o=t(35317),l=t(25610);let s=new Map,n=new Map,i=(0,a.vt)((e,r)=>({profile:null,loading:!1,error:null,fetchProfile:async r=>{var t,a;if(s.get(r))return void console.log("\uD83D\uDEAB BLOCKED: Already fetching profile for:",r);e({loading:!0,error:null});let i=n.get(r);if(i){console.log("\uD83D\uDCBE CACHE HIT: Using cached profile for:",r),e({profile:i,loading:!1,error:null});return}console.log("\uD83D\uDD0D Store: Starting fetchProfile for:",r);try{let i=await (0,o.x7)((0,o.doc)(l.db,"users",r));if(i.exists()){let o=i.data(),l=Object.assign(Object.assign({id:r,joinedAt:(null==(t=o.joinedAt)?void 0:t.toDate())||new Date,usernameLastChanged:null==(a=o.usernameLastChanged)?void 0:a.toDate()},o),{customPhotoURL:o.customPhotoURL||"",photoURL:o.photoURL||"",profilePic:o.profilePic||"",avatar:o.avatar||"",name:o.name&&"string"==typeof o.name&&o.name.trim()||"User",bio:o.bio&&"string"==typeof o.bio?o.bio.trim():"",followers:Array.isArray(o.followers)?o.followers:[],following:Array.isArray(o.following)?o.following:[]});console.log("✅ Store: Profile loaded successfully:",l.name,l.id),n.set(r,l),e({profile:l,loading:!1})}else console.log("❌ Store: Profile document does not exist for:",r),s.delete(r),e({profile:null,loading:!1,error:"Profile not found. This user may not exist or their profile may be private."})}catch(t){console.error("❌ Store: Firestore error:",t),s.delete(r),e({profile:null,loading:!1,error:"Failed to load profile. Please check your internet connection and try again."})}},subscribeToProfile:e=>(console.log("\uD83D\uDD14 Subscription disabled to prevent infinite loops for:",e),()=>{}),updateProfile:async(t,a)=>{try{await (0,o.mZ)((0,o.doc)(l.db,"users",t),a);let s=r().profile;s&&s.id===t&&e({profile:Object.assign(Object.assign({},s),a)})}catch(e){throw console.error("Error updating profile:",e),e}},createProfile:async(r,t)=>{try{let a=Object.assign(Object.assign({},t),{id:r,joinedAt:new Date});await (0,o.BN)((0,o.doc)(l.db,"users",r),a),e({profile:a,loading:!1,error:null})}catch(r){console.error("Error creating profile:",r),e({error:"Failed to create profile",loading:!1})}},followUser:async(t,a)=>{try{let s=(0,o.doc)(l.db,"users",t),n=(0,o.doc)(l.db,"users",a);await (0,o.mZ)(s,{following:(0,o.hq)(a)}),await (0,o.mZ)(n,{followers:(0,o.hq)(t)});let i=r().profile;if(i&&i.id===t){let r=Array.isArray(i.following)?i.following:[];e({profile:Object.assign(Object.assign({},i),{following:[...r.filter(e=>e!==a),a]})})}}catch(e){throw console.error("Error following user:",e),e}},unfollowUser:async(t,a)=>{try{let s=(0,o.doc)(l.db,"users",t),n=(0,o.doc)(l.db,"users",a);await (0,o.mZ)(s,{following:(0,o.C3)(a)}),await (0,o.mZ)(n,{followers:(0,o.C3)(t)});let i=r().profile;if(i&&i.id===t){let r=Array.isArray(i.following)?i.following:[];e({profile:Object.assign(Object.assign({},i),{following:r.filter(e=>e!==a)})})}}catch(e){throw console.error("Error unfollowing user:",e),e}},fetchUserAnalytics:async e=>{try{return{monthlySales:0,monthlyOrders:0,monthlyRefunds:0,topProducts:[]}}catch(e){throw console.error("Error fetching analytics:",e),e}},clearProfile:()=>{e({profile:null,loading:!1,error:null})},clearUserCache:e=>{n.delete(e),s.delete(e),console.log("\uD83D\uDDD1️ Cleared cache and tracker for:",e)}}))}},e=>{e.O(0,[2992,9507,1794,6671,8599,7194,8441,5964,7358],()=>e(e.s=89095)),_N_E=e.O()}]);