(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5610,6702],{4229:(e,r,t)=>{"use strict";t.d(r,{A:()=>o});let o=(0,t(19946).A)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])},6115:(e,r,t)=>{"use strict";var o=t(12115),a=t(49033),s="function"==typeof Object.is?Object.is:function(e,r){return e===r&&(0!==e||1/e==1/r)||e!=e&&r!=r},l=a.useSyncExternalStore,i=o.useRef,n=o.useEffect,c=o.useMemo,u=o.useDebugValue;r.useSyncExternalStoreWithSelector=function(e,r,t,o,a){var d=i(null);if(null===d.current){var p={hasValue:!1,value:null};d.current=p}else p=d.current;var g=l(e,(d=c(function(){function e(e){if(!n){if(n=!0,l=e,e=o(e),void 0!==a&&p.hasValue){var r=p.value;if(a(r,e))return i=r}return i=e}if(r=i,s(l,e))return r;var t=o(e);return void 0!==a&&a(r,t)?(l=e,r):(l=e,i=t)}var l,i,n=!1,c=void 0===t?null:t;return[function(){return e(r())},null===c?void 0:function(){return e(c())}]},[r,t,o,a]))[0],d[1]);return n(function(){p.hasValue=!0,p.value=g},[g]),u(g),g}},19946:(e,r,t)=>{"use strict";t.d(r,{A:()=>n});var o=t(12115);let a=e=>{let r=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,t)=>t?t.toUpperCase():r.toLowerCase());return r.charAt(0).toUpperCase()+r.slice(1)},s=function(){for(var e=arguments.length,r=Array(e),t=0;t<e;t++)r[t]=arguments[t];return r.filter((e,r,t)=>!!e&&""!==e.trim()&&t.indexOf(e)===r).join(" ").trim()};var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,o.forwardRef)((e,r)=>{let{color:t="currentColor",size:a=24,strokeWidth:i=2,absoluteStrokeWidth:n,className:c="",children:u,iconNode:d,...p}=e;return(0,o.createElement)("svg",{ref:r,...l,width:a,height:a,stroke:t,strokeWidth:n?24*Number(i)/Number(a):i,className:s("lucide",c),...!u&&!(e=>{for(let r in e)if(r.startsWith("aria-")||"role"===r||"title"===r)return!0})(p)&&{"aria-hidden":"true"},...p},[...d.map(e=>{let[r,t]=e;return(0,o.createElement)(r,t)}),...Array.isArray(u)?u:[u]])}),n=(e,r)=>{let t=(0,o.forwardRef)((t,l)=>{let{className:n,...c}=t;return(0,o.createElement)(i,{ref:l,iconNode:r,className:s("lucide-".concat(a(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),n),...c})});return t.displayName=a(e),t}},22436:(e,r,t)=>{"use strict";var o=t(12115),a="function"==typeof Object.is?Object.is:function(e,r){return e===r&&(0!==e||1/e==1/r)||e!=e&&r!=r},s=o.useState,l=o.useEffect,i=o.useLayoutEffect,n=o.useDebugValue;function c(e){var r=e.getSnapshot;e=e.value;try{var t=r();return!a(e,t)}catch(e){return!0}}var u="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,r){return r()}:function(e,r){var t=r(),o=s({inst:{value:t,getSnapshot:r}}),a=o[0].inst,u=o[1];return i(function(){a.value=t,a.getSnapshot=r,c(a)&&u({inst:a})},[e,t,r]),l(function(){return c(a)&&u({inst:a}),e(function(){c(a)&&u({inst:a})})},[e]),n(t),t};r.useSyncExternalStore=void 0!==o.useSyncExternalStore?o.useSyncExternalStore:u},25610:(e,r,t)=>{"use strict";t.d(r,{db:()=>p,j2:()=>d,storage:()=>g});var o=t(23915),a=t(16203),s=t(35317),l=t(90858),i=t(92144),n=t(81115),c=t(86864);let u=(0,o.Wp)({apiKey:"AIzaSyByhCgo_k9i8_AstSaZkZ3Atv5Rt2eOjhc",authDomain:"zaillisy.firebaseapp.com",databaseURL:"https://zaillisy-default-rtdb.firebaseio.com",projectId:"zaillisy",storageBucket:"zaillisy.firebasestorage.app",messagingSenderId:"984913226421",appId:"1:984913226421:web:c648bbccdd5055cf6cecfc",measurementId:"G-95WJ280TC9"}),d=(0,a.xI)(u),p=(0,s.aU)(u);(0,n.C3)(u);let g=(0,l.c7)(u);(0,i.Uz)(u);try{(0,c.TT)().then(e=>{e?((0,c.P5)(u),console.log("\uD83D\uDCCA Firebase Analytics enabled")):console.log("ℹ️ Firebase Analytics not supported in this environment")}).catch(()=>{console.warn("Analytics check failed; continuing without Analytics")})}catch(e){console.warn("Analytics initialization skipped:",e)}console.log("\uD83D\uDE80 Using production Firebase configuration for project:",u.options.projectId)},29869:(e,r,t)=>{"use strict";t.d(r,{A:()=>o});let o=(0,t(19946).A)("upload",[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]])},35169:(e,r,t)=>{"use strict";t.d(r,{A:()=>o});let o=(0,t(19946).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},35695:(e,r,t)=>{"use strict";var o=t(18999);t.o(o,"useParams")&&t.d(r,{useParams:function(){return o.useParams}}),t.o(o,"usePathname")&&t.d(r,{usePathname:function(){return o.usePathname}}),t.o(o,"useRouter")&&t.d(r,{useRouter:function(){return o.useRouter}}),t.o(o,"useSearchParams")&&t.d(r,{useSearchParams:function(){return o.useSearchParams}})},37108:(e,r,t)=>{"use strict";t.d(r,{A:()=>o});let o=(0,t(19946).A)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]])},45643:(e,r,t)=>{"use strict";e.exports=t(6115)},49033:(e,r,t)=>{"use strict";e.exports=t(22436)},54416:(e,r,t)=>{"use strict";t.d(r,{A:()=>o});let o=(0,t(19946).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},56616:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>b});var o=t(95155),a=t(12115),s=t(35695),l=t(68084),i=t(98868),n=t(29869),c=t(37108),u=t(35169),d=t(54416),p=t(84616),g=t(84355),h=t(4229),m=t(56671),f=t(6874),y=t.n(f);function b(){let{user:e,loading:r,refreshUserData:f}=(0,l.useAuthStore)(),{profile:b,loading:x,fetchProfile:v}=(0,i.n)(),w=(0,s.useRouter)(),j=(0,a.useRef)(!1),[N,A]=(0,a.useState)(!1),[k,P]=(0,a.useState)(!1),[S,U]=(0,a.useState)({name:"",description:"",price:0,category:"",condition:"new",location:"",tags:[],stock:1,images:[]}),[C,R]=(0,a.useState)(""),[E,L]=(0,a.useState)([]),O=(0,a.useRef)(null);(0,a.useEffect)(()=>{if(!r&&!j.current){if(!e)return void w.push("/auth-login");j.current=!0,(async()=>{try{await v(e.uid)}catch(e){console.error("Error fetching profile:",e),m.oR.error("Error loading profile information")}})()}},[null==e?void 0:e.uid,r,w]),(0,a.useEffect)(()=>{if(b){let e=["personal_seller","brand","company"];A(e.includes(b.role)),e.includes(b.role)||(m.oR.error("Only sellers can upload products"),w.push("/"))}},[b,w]);let D=(e,r)=>{U(t=>({...t,[e]:r}))},M=()=>{C.trim()&&!S.tags.includes(C.trim())&&(U(e=>({...e,tags:[...e.tags,C.trim()]})),R(""))},T=async()=>{if(e&&N){if(!S.name.trim())return void m.oR.error("Product name is required");if(!S.description.trim())return void m.oR.error("Product description is required");if(S.price<=0)return void m.oR.error("Price must be greater than 0");if(!S.category)return void m.oR.error("Please select a category");if(!S.location.trim())return void m.oR.error("Location is required");if(0===S.images.length)return void m.oR.error("Please upload at least one product image");P(!0);try{let{ref:r,uploadBytes:o,getDownloadURL:a}=await Promise.resolve().then(t.bind(t,90858)),{storage:s}=await Promise.resolve().then(t.bind(t,25610)),{collection:l,addDoc:i,serverTimestamp:n}=await Promise.resolve().then(t.bind(t,35317)),{db:c}=await Promise.resolve().then(t.bind(t,25610)),u=[];for(let t=0;t<E.length;t++){let l=E[t],i=Date.now(),n=r(s,"products/".concat(e.uid,"/").concat(i,"_").concat(t,"_").concat(l.name));await o(n,l);let c=await a(n);u.push(c)}let d={id:e.uid,name:(null==b?void 0:b.name)||e.displayName||"Unknown",photoURL:(null==b?void 0:b.customPhotoURL)||(null==b?void 0:b.photoURL)||e.photoURL||""},p={title:S.name,description:S.description,price:S.price,category:S.category,condition:S.condition,location:S.location,tags:S.tags,stock:S.stock,inventory:{total:S.stock,available:S.stock,reserved:0},images:u,sellerId:e.uid,sellerName:(null==b?void 0:b.name)||e.displayName||"Unknown",sellerPhoto:(null==b?void 0:b.customPhotoURL)||(null==b?void 0:b.photoURL)||e.photoURL||"",sellerRef:d,seller:{id:e.uid,name:(null==b?void 0:b.name)||e.displayName||"Unknown",avatar:(null==b?void 0:b.customPhotoURL)||(null==b?void 0:b.photoURL)||e.photoURL||"",isVerified:(null==b?void 0:b.verified)||!1,rating:(null==b?void 0:b.rating)||0},status:"active",likes:[],views:0,viewCount:0,sold:0,rating:0,reviewCount:0,likeCount:0,comments:0,brand:(null==b?void 0:b.name)||e.displayName||"Unknown",createdAt:n(),updatedAt:n()},g=await i(l(c,"products"),p);console.log("✅ PRODUCT UPLOAD: Product created successfully with ID:",g.id),console.log("\uD83D\uDCE6 PRODUCT UPLOAD: Product data:",p),m.oR.success("Product uploaded successfully!"),w.push("/profile/".concat(e.uid))}catch(e){console.error("Error uploading product:",e),m.oR.error("Failed to upload product. Please try again.")}finally{P(!1)}}};return r&&!e||x&&!b?(0,o.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,o.jsxs)("div",{className:"text-center",children:[(0,o.jsx)(n.A,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),(0,o.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Please login first"}),(0,o.jsx)("p",{className:"text-gray-600",children:"You need to be authenticated to upload products"})]})}):N?(0,o.jsxs)("div",{className:"min-h-screen bg-gray-50 pb-20",children:[(0,o.jsx)("div",{className:"bg-white shadow-sm border-b border-gray-200",children:(0,o.jsx)("div",{className:"max-w-4xl mx-auto px-4 py-4",children:(0,o.jsx)("div",{className:"flex items-center justify-between",children:(0,o.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,o.jsx)(y(),{href:"/",className:"p-2 rounded-lg hover:bg-gray-100 transition-colors",children:(0,o.jsx)(u.A,{className:"w-5 h-5 text-gray-600"})}),(0,o.jsxs)("div",{children:[(0,o.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"Upload Product"}),(0,o.jsx)("p",{className:"text-sm text-gray-600",children:"Add a new product to your store"})]})]})})})}),(0,o.jsx)("div",{className:"max-w-4xl mx-auto px-4 py-6",children:(0,o.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[(0,o.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Product Information"}),(0,o.jsxs)("div",{className:"space-y-6",children:[(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Product Name *"}),(0,o.jsx)("input",{type:"text",value:S.name,onChange:e=>D("name",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"Enter product name"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category *"}),(0,o.jsxs)("select",{value:S.category,onChange:e=>D("category",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",children:[(0,o.jsx)("option",{value:"",children:"Select category"}),(0,o.jsx)("option",{value:"electronics",children:"Electronics"}),(0,o.jsx)("option",{value:"clothing",children:"Clothing & Fashion"}),(0,o.jsx)("option",{value:"home",children:"Home & Garden"}),(0,o.jsx)("option",{value:"sports",children:"Sports & Outdoors"}),(0,o.jsx)("option",{value:"books",children:"Books & Media"}),(0,o.jsx)("option",{value:"automotive",children:"Automotive"}),(0,o.jsx)("option",{value:"health",children:"Health & Beauty"}),(0,o.jsx)("option",{value:"toys",children:"Toys & Games"}),(0,o.jsx)("option",{value:"jewelry",children:"Jewelry & Watches"}),(0,o.jsx)("option",{value:"other",children:"Other"})]})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description *"}),(0,o.jsx)("textarea",{value:S.description,onChange:e=>D("description",e.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"Describe your product in detail..."})]}),(0,o.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Price *"}),(0,o.jsxs)("div",{className:"relative",children:[(0,o.jsx)("span",{className:"absolute left-3 top-2 text-gray-500",children:"$"}),(0,o.jsx)("input",{type:"number",value:S.price,onChange:e=>D("price",parseFloat(e.target.value)||0),className:"w-full pl-8 pr-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"0.00",min:"0",step:"0.01"})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Stock Quantity"}),(0,o.jsx)("input",{type:"number",value:S.stock,onChange:e=>D("stock",parseInt(e.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"1",min:"0"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Condition"}),(0,o.jsxs)("select",{value:S.condition,onChange:e=>D("condition",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",children:[(0,o.jsx)("option",{value:"new",children:"New"}),(0,o.jsx)("option",{value:"used",children:"Used"}),(0,o.jsx)("option",{value:"refurbished",children:"Refurbished"})]})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Location *"}),(0,o.jsx)("input",{type:"text",value:S.location,onChange:e=>D("location",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"City, State"})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tags"}),(0,o.jsx)("div",{className:"flex flex-wrap gap-2 mb-2",children:S.tags.map((e,r)=>(0,o.jsxs)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-purple-100 text-purple-800",children:[e,(0,o.jsx)("button",{onClick:()=>{U(r=>({...r,tags:r.tags.filter(r=>r!==e)}))},className:"ml-2 text-purple-600 hover:text-purple-800",children:(0,o.jsx)(d.A,{className:"w-3 h-3"})})]},r))}),(0,o.jsxs)("div",{className:"flex",children:[(0,o.jsx)("input",{type:"text",value:C,onChange:e=>R(e.target.value),onKeyPress:e=>"Enter"===e.key&&M(),className:"flex-1 px-3 py-2 border border-gray-300 rounded-l-lg focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"Add a tag"}),(0,o.jsx)("button",{onClick:M,className:"px-4 py-2 bg-purple-600 text-white rounded-r-lg hover:bg-purple-700",children:(0,o.jsx)(p.A,{className:"w-4 h-4"})})]})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Product Images (Max 5, Max 5MB each)"}),S.images.length>0&&(0,o.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 mb-4",children:S.images.map((e,r)=>(0,o.jsxs)("div",{className:"relative group",children:[(0,o.jsx)("img",{src:e,alt:"Product ".concat(r+1),className:"w-full h-32 object-cover rounded-lg border border-gray-300"}),(0,o.jsx)("button",{type:"button",onClick:()=>{URL.revokeObjectURL(S.images[r]),L(e=>e.filter((e,t)=>t!==r)),U(e=>({...e,images:e.images.filter((e,t)=>t!==r)}))},className:"absolute top-2 right-2 p-1 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity",children:(0,o.jsx)(d.A,{className:"w-4 h-4"})})]},r))}),S.images.length<5&&(0,o.jsxs)("div",{children:[(0,o.jsx)("input",{ref:O,type:"file",accept:"image/*",multiple:!0,onChange:e=>{let r=e.target.files;if(!r)return;let t=Array.from(r);if(E.length+t.length>5)return void m.oR.error("Maximum 5 images allowed");for(let e of t)if(e.size>5242880)return void m.oR.error("".concat(e.name," is too large. Max 5MB per image"));let o=t.map(e=>URL.createObjectURL(e));L(e=>[...e,...t]),U(e=>({...e,images:[...e.images,...o]}))},className:"hidden"}),(0,o.jsxs)("button",{type:"button",onClick:()=>{var e;return null==(e=O.current)?void 0:e.click()},className:"w-full border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-purple-500 hover:bg-purple-50 transition-colors",children:[(0,o.jsx)(g.A,{className:"w-12 h-12 text-gray-400 mx-auto mb-2"}),(0,o.jsx)("p",{className:"text-gray-600",children:"Click to upload images"}),(0,o.jsxs)("p",{className:"text-sm text-gray-400 mt-1",children:[S.images.length,"/5 images uploaded"]})]})]})]}),(0,o.jsx)("div",{className:"flex justify-end pt-6 border-t border-gray-200",children:(0,o.jsx)("button",{onClick:T,disabled:k,className:"flex items-center px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50",children:k?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Uploading..."]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(h.A,{className:"w-4 h-4 mr-2"}),"Upload Product"]})})})]})]})})]}):(0,o.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,o.jsxs)("div",{className:"text-center",children:[(0,o.jsx)(c.A,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),(0,o.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-4",children:"Seller Access Required"}),(0,o.jsx)("p",{className:"text-gray-600 mb-4",children:"Only sellers can upload products"}),(0,o.jsx)(y(),{href:"/become-seller",className:"inline-flex items-center px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700",children:"Become a Seller"})]})})}},68084:(e,r,t)=>{"use strict";t.d(r,{useAuthStore:()=>i});var o=t(88693),a=t(16203),s=t(25610),l=t(95997);let i=(0,o.vt)((e,r)=>({user:null,userData:null,loading:!0,unsubscribeUserListener:null,setUser:r=>e({user:r}),setUserData:r=>e({userData:r}),setLoading:r=>e({loading:r}),setUnsubscribeUserListener:r=>e({unsubscribeUserListener:r}),initialize:()=>(0,a.hg)(s.j2,async o=>{if(o)try{let a=await (0,l.gL)(o.uid),s=Object.assign(Object.assign({},o),{role:null==a?void 0:a.role});e({user:s,userData:a,loading:!1});let{doc:i,onSnapshot:n}=await Promise.resolve().then(t.bind(t,35317)),{db:c}=await Promise.resolve().then(t.bind(t,25610)),u=i(c,"users",o.uid),d=n(u,t=>{if(t.exists()){let o=t.data();e({userData:o,user:Object.assign(Object.assign({},r().user||{}),{role:o.role})})}});e({unsubscribeUserListener:d})}catch(r){console.error("Error fetching user data:",r),e({user:Object.assign(Object.assign({},o),{role:void 0}),userData:null,loading:!1})}else{let{unsubscribeUserListener:t}=r();t&&(t(),e({unsubscribeUserListener:null})),e({user:null,userData:null,loading:!1})}}),refreshUserData:async()=>{let{user:t}=r();if(t)try{let o=await (0,l.gL)(t.uid);e({userData:o,user:Object.assign(Object.assign({},r().user||{}),{role:null==o?void 0:o.role})}),setTimeout(async()=>{try{let o=await (0,l.gL)(t.uid);e({userData:o,user:Object.assign(Object.assign({},r().user||{}),{role:null==o?void 0:o.role})})}catch(e){console.warn("Error in delayed refresh:",e)}},500)}catch(e){console.error("Error refreshing user data:",e)}}}));setTimeout(()=>{i.getState().initialize()},0)},78284:(e,r,t)=>{Promise.resolve().then(t.bind(t,56616))},84355:(e,r,t)=>{"use strict";t.d(r,{A:()=>o});let o=(0,t(19946).A)("camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]])},84616:(e,r,t)=>{"use strict";t.d(r,{A:()=>o});let o=(0,t(19946).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},88693:(e,r,t)=>{"use strict";t.d(r,{vt:()=>u});let o=e=>{let r,t=new Set,o=(e,o)=>{let a="function"==typeof e?e(r):e;if(!Object.is(a,r)){let e=r;r=(null!=o?o:"object"!=typeof a||null===a)?a:Object.assign({},r,a),t.forEach(t=>t(r,e))}},a=()=>r,s={setState:o,getState:a,getInitialState:()=>l,subscribe:e=>(t.add(e),()=>t.delete(e)),destroy:()=>{console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},l=r=e(o,a,s);return s};var a=t(12115),s=t(45643);let{useDebugValue:l}=a,{useSyncExternalStoreWithSelector:i}=s,n=!1,c=e=>{"function"!=typeof e&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");let r="function"==typeof e?(e=>e?o(e):o)(e):e,t=(e,t)=>(function(e,r=e=>e,t){t&&!n&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),n=!0);let o=i(e.subscribe,e.getState,e.getServerState||e.getInitialState,r,t);return l(o),o})(r,e,t);return Object.assign(t,r),t},u=e=>e?c(e):c},95997:(e,r,t)=>{"use strict";t.d(r,{G6:()=>i,HW:()=>d,Hh:()=>c,Jv:()=>n,eT:()=>f,gL:()=>p,qc:()=>m,xw:()=>u});var o=t(16203),a=t(35317),s=t(25610);let l=new o.HF;l.addScope("email"),l.addScope("profile");let i=async()=>{var e;try{let r=(await (0,o.df)(s.j2,l)).user;if(!(await (0,a.x7)((0,a.doc)(s.db,"users",r.uid))).exists()){let t={id:r.uid,email:r.email||"",name:r.displayName||"Anonymous",username:(null==(e=r.email)?void 0:e.split("@")[0])||"user",avatar:r.photoURL||"",role:"user",accountType:"user",isVerified:!1,isVerifiedSeller:!1,isActive:!0,createdAt:new Date,updatedAt:new Date,followersCount:0,followingCount:0,productsCount:0,rating:0,totalSales:0};await (0,a.BN)((0,a.doc)(s.db,"users",r.uid),t)}return r}catch(e){throw console.error("Google sign-in error:",e),e}},n=async(e,r)=>{try{return(await (0,o.x9)(s.j2,e,r)).user}catch(e){throw e}},c=async function(e,r,t){let l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"user";try{let i=(await (0,o.eJ)(s.j2,e,r)).user;await (0,o.r7)(i,{displayName:t});try{let r={id:i.uid,email:i.email||"",name:t,username:e.split("@")[0],avatar:i.photoURL||"",bio:"",role:l,accountType:l,isVerified:!1,isVerifiedSeller:!1,isActive:!0,createdAt:new Date,updatedAt:new Date,followersCount:0,followingCount:0,productsCount:0,rating:0,totalSales:0};await (0,a.BN)((0,a.doc)(s.db,"users",i.uid),r),console.log("✅ User profile created successfully")}catch(e){console.warn("Could not create user document in Firestore:",e)}return i}catch(e){throw console.error("Signup error:",e),e}},u=async e=>{try{await (0,o.J1)(s.j2,e)}catch(e){throw e}},d=()=>s.j2.currentUser,p=async e=>{try{let r=await (0,a.x7)((0,a.doc)(s.db,"users",e));if(r.exists())return r.data();return null}catch(e){return console.error("Error getting user data:",e),null}},g=async e=>{try{let r=await p(e);return(null==r?void 0:r.role)||"user"}catch(e){return console.error("Error checking user role:",e),"user"}},h=async e=>{try{let r=await p(e);return(null==r?void 0:r.accountType)||"user"}catch(e){return console.error("Error checking account type:",e),"user"}},m=async e=>"admin"===await g(e),f=async e=>["personal_seller","brand","company"].includes(await h(e))},98868:(e,r,t)=>{"use strict";t.d(r,{n:()=>n});var o=t(88693),a=t(35317),s=t(25610);let l=new Map,i=new Map,n=(0,o.vt)((e,r)=>({profile:null,loading:!1,error:null,fetchProfile:async r=>{var t,o;if(l.get(r))return void console.log("\uD83D\uDEAB BLOCKED: Already fetching profile for:",r);e({loading:!0,error:null});let n=i.get(r);if(n){console.log("\uD83D\uDCBE CACHE HIT: Using cached profile for:",r),e({profile:n,loading:!1,error:null});return}console.log("\uD83D\uDD0D Store: Starting fetchProfile for:",r);try{let n=await (0,a.x7)((0,a.doc)(s.db,"users",r));if(n.exists()){let a=n.data(),s=Object.assign(Object.assign({id:r,joinedAt:(null==(t=a.joinedAt)?void 0:t.toDate())||new Date,usernameLastChanged:null==(o=a.usernameLastChanged)?void 0:o.toDate()},a),{customPhotoURL:a.customPhotoURL||"",photoURL:a.photoURL||"",profilePic:a.profilePic||"",avatar:a.avatar||"",name:a.name&&"string"==typeof a.name&&a.name.trim()||"User",bio:a.bio&&"string"==typeof a.bio?a.bio.trim():"",followers:Array.isArray(a.followers)?a.followers:[],following:Array.isArray(a.following)?a.following:[]});console.log("✅ Store: Profile loaded successfully:",s.name,s.id),i.set(r,s),e({profile:s,loading:!1})}else console.log("❌ Store: Profile document does not exist for:",r),l.delete(r),e({profile:null,loading:!1,error:"Profile not found. This user may not exist or their profile may be private."})}catch(t){console.error("❌ Store: Firestore error:",t),l.delete(r),e({profile:null,loading:!1,error:"Failed to load profile. Please check your internet connection and try again."})}},subscribeToProfile:e=>(console.log("\uD83D\uDD14 Subscription disabled to prevent infinite loops for:",e),()=>{}),updateProfile:async(t,o)=>{try{await (0,a.mZ)((0,a.doc)(s.db,"users",t),o);let l=r().profile;l&&l.id===t&&e({profile:Object.assign(Object.assign({},l),o)})}catch(e){throw console.error("Error updating profile:",e),e}},createProfile:async(r,t)=>{try{let o=Object.assign(Object.assign({},t),{id:r,joinedAt:new Date});await (0,a.BN)((0,a.doc)(s.db,"users",r),o),e({profile:o,loading:!1,error:null})}catch(r){console.error("Error creating profile:",r),e({error:"Failed to create profile",loading:!1})}},followUser:async(t,o)=>{try{let l=(0,a.doc)(s.db,"users",t),i=(0,a.doc)(s.db,"users",o);await (0,a.mZ)(l,{following:(0,a.hq)(o)}),await (0,a.mZ)(i,{followers:(0,a.hq)(t)});let n=r().profile;if(n&&n.id===t){let r=Array.isArray(n.following)?n.following:[];e({profile:Object.assign(Object.assign({},n),{following:[...r.filter(e=>e!==o),o]})})}}catch(e){throw console.error("Error following user:",e),e}},unfollowUser:async(t,o)=>{try{let l=(0,a.doc)(s.db,"users",t),i=(0,a.doc)(s.db,"users",o);await (0,a.mZ)(l,{following:(0,a.C3)(o)}),await (0,a.mZ)(i,{followers:(0,a.C3)(t)});let n=r().profile;if(n&&n.id===t){let r=Array.isArray(n.following)?n.following:[];e({profile:Object.assign(Object.assign({},n),{following:r.filter(e=>e!==o)})})}}catch(e){throw console.error("Error unfollowing user:",e),e}},fetchUserAnalytics:async e=>{try{return{monthlySales:0,monthlyOrders:0,monthlyRefunds:0,topProducts:[]}}catch(e){throw console.error("Error fetching analytics:",e),e}},clearProfile:()=>{e({profile:null,loading:!1,error:null})},clearUserCache:e=>{i.delete(e),l.delete(e),console.log("\uD83D\uDDD1️ Cleared cache and tracker for:",e)}}))}},e=>{e.O(0,[2992,9507,1794,6671,8599,7194,6874,8441,5964,7358],()=>e(e.s=78284)),_N_E=e.O()}]);