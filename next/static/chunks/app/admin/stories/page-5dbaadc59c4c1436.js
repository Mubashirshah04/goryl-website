(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3428,5610],{6115:(e,t,s)=>{"use strict";var r=s(12115),a=s(49033),i="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},o=a.useSyncExternalStore,n=r.useRef,c=r.useEffect,l=r.useMemo,u=r.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,s,r,a){var d=n(null);if(null===d.current){var h={hasValue:!1,value:null};d.current=h}else h=d.current;var f=o(e,(d=l(function(){function e(e){if(!c){if(c=!0,o=e,e=r(e),void 0!==a&&h.hasValue){var t=h.value;if(a(t,e))return n=t}return n=e}if(t=n,i(o,e))return t;var s=r(e);return void 0!==a&&a(t,s)?(o=e,t):(o=e,n=s)}var o,n,c=!1,l=void 0===s?null:s;return[function(){return e(t())},null===l?void 0:function(){return e(l())}]},[t,s,r,a]))[0],d[1]);return c(function(){h.hasValue=!0,h.value=f},[f]),u(f),f}},18740:(e,t,s)=>{Promise.resolve().then(s.bind(s,46854))},22436:(e,t,s)=>{"use strict";var r=s(12115),a="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},i=r.useState,o=r.useEffect,n=r.useLayoutEffect,c=r.useDebugValue;function l(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!a(e,s)}catch(e){return!0}}var u="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var s=t(),r=i({inst:{value:s,getSnapshot:t}}),a=r[0].inst,u=r[1];return n(function(){a.value=s,a.getSnapshot=t,l(a)&&u({inst:a})},[e,s,t]),o(function(){return l(a)&&u({inst:a}),e(function(){l(a)&&u({inst:a})})},[e]),c(s),s};t.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:u},25610:(e,t,s)=>{"use strict";s.d(t,{db:()=>h,j2:()=>d,storage:()=>f});var r=s(23915),a=s(16203),i=s(35317),o=s(90858),n=s(92144),c=s(81115),l=s(86864);let u=(0,r.Wp)({apiKey:"AIzaSyByhCgo_k9i8_AstSaZkZ3Atv5Rt2eOjhc",authDomain:"zaillisy.firebaseapp.com",databaseURL:"https://zaillisy-default-rtdb.firebaseio.com",projectId:"zaillisy",storageBucket:"zaillisy.firebasestorage.app",messagingSenderId:"984913226421",appId:"1:984913226421:web:c648bbccdd5055cf6cecfc",measurementId:"G-95WJ280TC9"}),d=(0,a.xI)(u),h=(0,i.aU)(u);(0,c.C3)(u);let f=(0,o.c7)(u);(0,n.Uz)(u);try{(0,l.TT)().then(e=>{e?((0,l.P5)(u),console.log("\uD83D\uDCCA Firebase Analytics enabled")):console.log("ℹ️ Firebase Analytics not supported in this environment")}).catch(()=>{console.warn("Analytics check failed; continuing without Analytics")})}catch(e){console.warn("Analytics initialization skipped:",e)}console.log("\uD83D\uDE80 Using production Firebase configuration for project:",u.options.projectId)},35695:(e,t,s)=>{"use strict";var r=s(18999);s.o(r,"useParams")&&s.d(t,{useParams:function(){return r.useParams}}),s.o(r,"usePathname")&&s.d(t,{usePathname:function(){return r.usePathname}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}}),s.o(r,"useSearchParams")&&s.d(t,{useSearchParams:function(){return r.useSearchParams}})},45643:(e,t,s)=>{"use strict";e.exports=s(6115)},46854:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>y});var r=s(95155),a=s(12115),i=s(35317),o=s(25610);let n=async()=>{try{let e=(0,i.query)((0,i.collection)(o.db,"stories")),t=await (0,i.getDocs)(e),s=t.docs.map(e=>(0,i.kd)(e.ref));return await Promise.all(s),console.log("Successfully deleted ".concat(t.size," stories")),t.size}catch(e){throw console.error("Error deleting stories:",e),e}},c=async()=>{try{let e=(0,i.query)((0,i.collection)(o.db,"stories"),(0,i.where)("isActive","==",!0)),t=await (0,i.getDocs)(e),s=t.docs.map(e=>(0,i.kd)(e.ref));return await Promise.all(s),console.log("Successfully deleted ".concat(t.size," active stories")),t.size}catch(e){throw console.error("Error deleting active stories:",e),e}},l=async()=>{try{for(let e of[{userId:"testUser1",userName:"Test User 1",userPhoto:"https://api.dicebear.com/7.x/avataaars/svg?seed=Test1",storyImage:"https://images.unsplash.com/photo-1501854140801-50d01698950b?w=400&h=600&fit=crop",storyImagePath:"",storyVideo:"",storyVideoPath:"",mediaType:"image",privacy:"public",createdAt:(0,i.serverTimestamp)(),expiresAt:i.Dc.fromDate(new Date(Date.now()+864e5)),views:[],isActive:!0},{userId:"testUser2",userName:"Test User 2",userPhoto:"https://api.dicebear.com/7.x/avataaars/svg?seed=Test2",storyImage:"https://images.unsplash.com/photo-1470071459604-3b5ec3a7fe05?w=400&h=600&fit=crop",storyImagePath:"",storyVideo:"",storyVideoPath:"",mediaType:"image",privacy:"public",createdAt:(0,i.serverTimestamp)(),expiresAt:i.Dc.fromDate(new Date(Date.now()+864e5)),views:[],isActive:!0},{userId:"testUser3",userName:"Test User 3",userPhoto:"https://api.dicebear.com/7.x/avataaars/svg?seed=Test3",storyImage:"https://images.unsplash.com/photo-1469474968028-56623f02e42e?w=400&h=600&fit=crop",storyImagePath:"",storyVideo:"",storyVideoPath:"",mediaType:"image",privacy:"public",createdAt:(0,i.serverTimestamp)(),expiresAt:i.Dc.fromDate(new Date(Date.now()+864e5)),views:[],isActive:!0}]){let t=await (0,i.addDoc)((0,i.collection)(o.db,"stories"),e);console.log("Added test story with ID:",t.id)}console.log("Successfully added test stories")}catch(e){throw console.error("Error adding test stories:",e),e}};var u=s(56671);function d(){let[e,t]=(0,a.useState)(!1),s=async()=>{if(confirm("Are you sure you want to delete ALL stories? This cannot be undone.")){t(!0);try{let e=await n();u.oR.success("Successfully deleted ".concat(e," stories"))}catch(e){console.error("Error clearing stories:",e),u.oR.error("Failed to clear stories")}finally{t(!1)}}},i=async()=>{if(confirm("Are you sure you want to delete all active stories?")){t(!0);try{let e=await c();u.oR.success("Successfully deleted ".concat(e," active stories"))}catch(e){console.error("Error clearing active stories:",e),u.oR.error("Failed to clear active stories")}finally{t(!1)}}},o=async()=>{t(!0);try{await l(),u.oR.success("Successfully added test stories")}catch(e){console.error("Error adding test stories:",e),u.oR.error("Failed to add test stories")}finally{t(!1)}};return(0,r.jsxs)("div",{className:"p-6 bg-white rounded-lg shadow-md",children:[(0,r.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Story Management"}),(0,r.jsx)("p",{className:"text-gray-600 mb-6",children:"Use these buttons to manage stories for testing purposes."}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-4",children:[(0,r.jsx)("button",{onClick:s,disabled:e,className:"px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600 disabled:opacity-50",children:e?"Processing...":"Clear All Stories"}),(0,r.jsx)("button",{onClick:i,disabled:e,className:"px-4 py-2 bg-orange-500 text-white rounded hover:bg-orange-600 disabled:opacity-50",children:e?"Processing...":"Clear Active Stories"}),(0,r.jsx)("button",{onClick:o,disabled:e,className:"px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600 disabled:opacity-50",children:e?"Processing...":"Add Test Stories"})]})]})}var h=s(68084),f=s(35695);function y(){let{user:e,loading:t}=(0,h.useAuthStore)(),s=(0,f.useRouter)();return(a.useEffect(()=>{t||e||s.push("/login")},[e,t,s]),t)?(0,r.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):e?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 py-12",children:(0,r.jsxs)("div",{className:"max-w-4xl mx-auto px-4",children:[(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Story Management"}),(0,r.jsx)("p",{className:"text-gray-600 mt-2",children:"Manage stories for testing purposes"})]}),(0,r.jsx)(d,{}),(0,r.jsxs)("div",{className:"mt-8 p-4 bg-blue-50 rounded-lg",children:[(0,r.jsx)("h3",{className:"font-medium text-blue-800",children:"Instructions"}),(0,r.jsxs)("ul",{className:"list-disc pl-5 mt-2 text-blue-700 space-y-1",children:[(0,r.jsx)("li",{children:"First, clear existing stories if needed"}),(0,r.jsx)("li",{children:"Then add test stories to see if the issue is resolved"}),(0,r.jsx)("li",{children:"Check the Stories section to verify the new stories appear correctly"})]})]})]})}):null}},49033:(e,t,s)=>{"use strict";e.exports=s(22436)},68084:(e,t,s)=>{"use strict";s.d(t,{useAuthStore:()=>n});var r=s(88693),a=s(16203),i=s(25610),o=s(95997);let n=(0,r.vt)((e,t)=>({user:null,userData:null,loading:!0,unsubscribeUserListener:null,setUser:t=>e({user:t}),setUserData:t=>e({userData:t}),setLoading:t=>e({loading:t}),setUnsubscribeUserListener:t=>e({unsubscribeUserListener:t}),initialize:()=>(0,a.hg)(i.j2,async r=>{if(r)try{let a=await (0,o.gL)(r.uid),i=Object.assign(Object.assign({},r),{role:null==a?void 0:a.role});e({user:i,userData:a,loading:!1});let{doc:n,onSnapshot:c}=await Promise.resolve().then(s.bind(s,35317)),{db:l}=await Promise.resolve().then(s.bind(s,25610)),u=n(l,"users",r.uid),d=c(u,s=>{if(s.exists()){let r=s.data();e({userData:r,user:Object.assign(Object.assign({},t().user||{}),{role:r.role})})}});e({unsubscribeUserListener:d})}catch(t){console.error("Error fetching user data:",t),e({user:Object.assign(Object.assign({},r),{role:void 0}),userData:null,loading:!1})}else{let{unsubscribeUserListener:s}=t();s&&(s(),e({unsubscribeUserListener:null})),e({user:null,userData:null,loading:!1})}}),refreshUserData:async()=>{let{user:s}=t();if(s)try{let r=await (0,o.gL)(s.uid);e({userData:r,user:Object.assign(Object.assign({},t().user||{}),{role:null==r?void 0:r.role})}),setTimeout(async()=>{try{let r=await (0,o.gL)(s.uid);e({userData:r,user:Object.assign(Object.assign({},t().user||{}),{role:null==r?void 0:r.role})})}catch(e){console.warn("Error in delayed refresh:",e)}},500)}catch(e){console.error("Error refreshing user data:",e)}}}));setTimeout(()=>{n.getState().initialize()},0)},88693:(e,t,s)=>{"use strict";s.d(t,{vt:()=>u});let r=e=>{let t,s=new Set,r=(e,r)=>{let a="function"==typeof e?e(t):e;if(!Object.is(a,t)){let e=t;t=(null!=r?r:"object"!=typeof a||null===a)?a:Object.assign({},t,a),s.forEach(s=>s(t,e))}},a=()=>t,i={setState:r,getState:a,getInitialState:()=>o,subscribe:e=>(s.add(e),()=>s.delete(e)),destroy:()=>{console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),s.clear()}},o=t=e(r,a,i);return i};var a=s(12115),i=s(45643);let{useDebugValue:o}=a,{useSyncExternalStoreWithSelector:n}=i,c=!1,l=e=>{"function"!=typeof e&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");let t="function"==typeof e?(e=>e?r(e):r)(e):e,s=(e,s)=>(function(e,t=e=>e,s){s&&!c&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),c=!0);let r=n(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,s);return o(r),r})(t,e,s);return Object.assign(s,t),s},u=e=>e?l(e):l},95997:(e,t,s)=>{"use strict";s.d(t,{G6:()=>n,HW:()=>d,Hh:()=>l,Jv:()=>c,eT:()=>p,gL:()=>h,qc:()=>g,xw:()=>u});var r=s(16203),a=s(35317),i=s(25610);let o=new r.HF;o.addScope("email"),o.addScope("profile");let n=async()=>{var e;try{let t=(await (0,r.df)(i.j2,o)).user;if(!(await (0,a.x7)((0,a.doc)(i.db,"users",t.uid))).exists()){let s={id:t.uid,email:t.email||"",name:t.displayName||"Anonymous",username:(null==(e=t.email)?void 0:e.split("@")[0])||"user",avatar:t.photoURL||"",role:"user",accountType:"user",isVerified:!1,isVerifiedSeller:!1,isActive:!0,createdAt:new Date,updatedAt:new Date,followersCount:0,followingCount:0,productsCount:0,rating:0,totalSales:0};await (0,a.BN)((0,a.doc)(i.db,"users",t.uid),s)}return t}catch(e){throw console.error("Google sign-in error:",e),e}},c=async(e,t)=>{try{return(await (0,r.x9)(i.j2,e,t)).user}catch(e){throw e}},l=async function(e,t,s){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"user";try{let n=(await (0,r.eJ)(i.j2,e,t)).user;await (0,r.r7)(n,{displayName:s});try{let t={id:n.uid,email:n.email||"",name:s,username:e.split("@")[0],avatar:n.photoURL||"",bio:"",role:o,accountType:o,isVerified:!1,isVerifiedSeller:!1,isActive:!0,createdAt:new Date,updatedAt:new Date,followersCount:0,followingCount:0,productsCount:0,rating:0,totalSales:0};await (0,a.BN)((0,a.doc)(i.db,"users",n.uid),t),console.log("✅ User profile created successfully")}catch(e){console.warn("Could not create user document in Firestore:",e)}return n}catch(e){throw console.error("Signup error:",e),e}},u=async e=>{try{await (0,r.J1)(i.j2,e)}catch(e){throw e}},d=()=>i.j2.currentUser,h=async e=>{try{let t=await (0,a.x7)((0,a.doc)(i.db,"users",e));if(t.exists())return t.data();return null}catch(e){return console.error("Error getting user data:",e),null}},f=async e=>{try{let t=await h(e);return(null==t?void 0:t.role)||"user"}catch(e){return console.error("Error checking user role:",e),"user"}},y=async e=>{try{let t=await h(e);return(null==t?void 0:t.accountType)||"user"}catch(e){return console.error("Error checking account type:",e),"user"}},g=async e=>"admin"===await f(e),p=async e=>["personal_seller","brand","company"].includes(await y(e))}},e=>{e.O(0,[2992,9507,1794,6671,8599,7194,8441,5964,7358],()=>e(e.s=18740)),_N_E=e.O()}]);