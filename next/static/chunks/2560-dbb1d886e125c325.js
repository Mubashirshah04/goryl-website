"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2560,5610],{22740:(e,r,o)=>{o.d(r,{x:()=>s});var t=o(88693),a=o(35317),i=o(25610);let s=(0,t.vt)((e,r)=>({reviews:[],loading:!1,error:null,fetchUserReviews:async r=>{e({loading:!0,error:null});try{let o=(0,a.query)((0,a.collection)(i.db,"reviews"),(0,a.where)("sellerId","==",r),(0,a.My)("createdAt","desc"),(0,a.AB)(50)),t=(await (0,a.getDocs)(o)).docs.map(e=>Object.assign({id:e.id},e.data()));e({reviews:t,loading:!1})}catch(r){console.error("Error fetching user reviews:",r),e({loading:!1,error:"Failed to load reviews"})}},fetchUserReviewsRealtime:r=>{let o=(0,a.query)((0,a.collection)(i.db,"reviews"),(0,a.where)("sellerId","==",r),(0,a.My)("createdAt","desc"),(0,a.AB)(50));return(0,a.onSnapshot)(o,r=>{e({reviews:r.docs.map(e=>Object.assign({id:e.id},e.data())),loading:!1})},r=>{console.error("Error fetching user reviews:",r),e({loading:!1,error:"Failed to load reviews"})})},addReview:async o=>{try{let t=Object.assign(Object.assign({},o),{helpful:0,createdAt:new Date}),s=await (0,a.addDoc)((0,a.collection)(i.db,"reviews"),t),l=r().reviews;e({reviews:[Object.assign({id:s.id},t),...l]})}catch(r){console.error("Error adding review:",r),e({error:"Failed to add review"})}},updateReview:async(o,t)=>{try{await (0,a.mZ)((0,a.doc)(i.db,"reviews",o),t);let s=r().reviews.map(e=>e.id===o?Object.assign(Object.assign({},e),t):e);e({reviews:s})}catch(r){console.error("Error updating review:",r),e({error:"Failed to update review"})}},deleteReview:async o=>{try{await (0,a.kd)((0,a.doc)(i.db,"reviews",o));let t=r().reviews.filter(e=>e.id!==o);e({reviews:t})}catch(r){console.error("Error deleting review:",r),e({error:"Failed to delete review"})}},markHelpful:async o=>{try{await (0,a.mZ)((0,a.doc)(i.db,"reviews",o),{helpful:(0,a.GV)(1)});let t=r().reviews.map(e=>e.id===o?Object.assign(Object.assign({},e),{helpful:e.helpful+1}):e);e({reviews:t})}catch(r){console.error("Error marking review helpful:",r),e({error:"Failed to mark review helpful"})}},clearReviews:()=>{e({reviews:[],loading:!1,error:null})}}))},25610:(e,r,o)=>{o.d(r,{db:()=>g,j2:()=>u,storage:()=>w});var t=o(23915),a=o(16203),i=o(35317),s=o(90858),l=o(92144),n=o(81115),c=o(86864);let d=(0,t.Wp)({apiKey:"AIzaSyByhCgo_k9i8_AstSaZkZ3Atv5Rt2eOjhc",authDomain:"zaillisy.firebaseapp.com",databaseURL:"https://zaillisy-default-rtdb.firebaseio.com",projectId:"zaillisy",storageBucket:"zaillisy.firebasestorage.app",messagingSenderId:"984913226421",appId:"1:984913226421:web:c648bbccdd5055cf6cecfc",measurementId:"G-95WJ280TC9"}),u=(0,a.xI)(d),g=(0,i.aU)(d);(0,n.C3)(d);let w=(0,s.c7)(d);(0,l.Uz)(d);try{(0,c.TT)().then(e=>{e?((0,c.P5)(d),console.log("\uD83D\uDCCA Firebase Analytics enabled")):console.log("ℹ️ Firebase Analytics not supported in this environment")}).catch(()=>{console.warn("Analytics check failed; continuing without Analytics")})}catch(e){console.warn("Analytics initialization skipped:",e)}console.log("\uD83D\uDE80 Using production Firebase configuration for project:",d.options.projectId)},28203:(e,r,o)=>{o.d(r,{a:()=>s});var t=o(88693),a=o(35317),i=o(25610);let s=(0,t.vt)((e,r)=>({products:[],loading:!1,error:null,fetchUserProducts:async r=>{e({loading:!0,error:null});try{let o=(0,a.query)((0,a.collection)(i.db,"products"),(0,a.where)("sellerId","==",r),(0,a.My)("createdAt","desc")),t=(await (0,a.getDocs)(o)).docs.map(e=>Object.assign({id:e.id},e.data()));e({products:t,loading:!1})}catch(r){console.error("Error fetching user products:",r),e({loading:!1,error:"Failed to load products"})}},fetchUserProductsRealtime:r=>{let o=(0,a.query)((0,a.collection)(i.db,"products"),(0,a.where)("sellerId","==",r),(0,a.My)("createdAt","desc"));return(0,a.onSnapshot)(o,r=>{e({products:r.docs.map(e=>Object.assign({id:e.id},e.data())),loading:!1})},r=>{console.error("Error fetching user products:",r),e({loading:!1,error:"Failed to load products"})})},addProduct:async o=>{try{let t=Object.assign(Object.assign({},o),{likes:0,views:0,createdAt:new Date,updatedAt:new Date}),s=await (0,a.addDoc)((0,a.collection)(i.db,"products"),t),l=r().products;e({products:[Object.assign({id:s.id},t),...l]})}catch(r){console.error("Error adding product:",r),e({error:"Failed to add product"})}},updateProduct:async(o,t)=>{try{await (0,a.mZ)((0,a.doc)(i.db,"products",o),Object.assign(Object.assign({},t),{updatedAt:new Date}));let s=r().products.map(e=>e.id===o?Object.assign(Object.assign(Object.assign({},e),t),{updatedAt:new Date}):e);e({products:s})}catch(r){console.error("Error updating product:",r),e({error:"Failed to update product"})}},deleteProduct:async o=>{try{await (0,a.kd)((0,a.doc)(i.db,"products",o));let t=r().products.filter(e=>e.id!==o);e({products:t})}catch(r){console.error("Error deleting product:",r),e({error:"Failed to delete product"})}},clearProducts:()=>{e({products:[],loading:!1,error:null})}}))},68084:(e,r,o)=>{o.d(r,{useAuthStore:()=>l});var t=o(88693),a=o(16203),i=o(25610),s=o(95997);let l=(0,t.vt)((e,r)=>({user:null,userData:null,loading:!0,unsubscribeUserListener:null,setUser:r=>e({user:r}),setUserData:r=>e({userData:r}),setLoading:r=>e({loading:r}),setUnsubscribeUserListener:r=>e({unsubscribeUserListener:r}),initialize:()=>(0,a.hg)(i.j2,async t=>{if(t)try{let a=await (0,s.gL)(t.uid),i=Object.assign(Object.assign({},t),{role:null==a?void 0:a.role});e({user:i,userData:a,loading:!1});let{doc:l,onSnapshot:n}=await Promise.resolve().then(o.bind(o,35317)),{db:c}=await Promise.resolve().then(o.bind(o,25610)),d=l(c,"users",t.uid),u=n(d,o=>{if(o.exists()){let t=o.data();e({userData:t,user:Object.assign(Object.assign({},r().user||{}),{role:t.role})})}});e({unsubscribeUserListener:u})}catch(r){console.error("Error fetching user data:",r),e({user:Object.assign(Object.assign({},t),{role:void 0}),userData:null,loading:!1})}else{let{unsubscribeUserListener:o}=r();o&&(o(),e({unsubscribeUserListener:null})),e({user:null,userData:null,loading:!1})}}),refreshUserData:async()=>{let{user:o}=r();if(o)try{let t=await (0,s.gL)(o.uid);e({userData:t,user:Object.assign(Object.assign({},r().user||{}),{role:null==t?void 0:t.role})}),setTimeout(async()=>{try{let t=await (0,s.gL)(o.uid);e({userData:t,user:Object.assign(Object.assign({},r().user||{}),{role:null==t?void 0:t.role})})}catch(e){console.warn("Error in delayed refresh:",e)}},500)}catch(e){console.error("Error refreshing user data:",e)}}}));setTimeout(()=>{l.getState().initialize()},0)},95997:(e,r,o)=>{o.d(r,{G6:()=>l,HW:()=>u,Hh:()=>c,Jv:()=>n,eT:()=>y,gL:()=>g,qc:()=>p,xw:()=>d});var t=o(16203),a=o(35317),i=o(25610);let s=new t.HF;s.addScope("email"),s.addScope("profile");let l=async()=>{var e;try{let r=(await (0,t.df)(i.j2,s)).user;if(!(await (0,a.x7)((0,a.doc)(i.db,"users",r.uid))).exists()){let o={id:r.uid,email:r.email||"",name:r.displayName||"Anonymous",username:(null==(e=r.email)?void 0:e.split("@")[0])||"user",avatar:r.photoURL||"",role:"user",accountType:"user",isVerified:!1,isVerifiedSeller:!1,isActive:!0,createdAt:new Date,updatedAt:new Date,followersCount:0,followingCount:0,productsCount:0,rating:0,totalSales:0};await (0,a.BN)((0,a.doc)(i.db,"users",r.uid),o)}return r}catch(e){throw console.error("Google sign-in error:",e),e}},n=async(e,r)=>{try{return(await (0,t.x9)(i.j2,e,r)).user}catch(e){throw e}},c=async function(e,r,o){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"user";try{let l=(await (0,t.eJ)(i.j2,e,r)).user;await (0,t.r7)(l,{displayName:o});try{let r={id:l.uid,email:l.email||"",name:o,username:e.split("@")[0],avatar:l.photoURL||"",bio:"",role:s,accountType:s,isVerified:!1,isVerifiedSeller:!1,isActive:!0,createdAt:new Date,updatedAt:new Date,followersCount:0,followingCount:0,productsCount:0,rating:0,totalSales:0};await (0,a.BN)((0,a.doc)(i.db,"users",l.uid),r),console.log("✅ User profile created successfully")}catch(e){console.warn("Could not create user document in Firestore:",e)}return l}catch(e){throw console.error("Signup error:",e),e}},d=async e=>{try{await (0,t.J1)(i.j2,e)}catch(e){throw e}},u=()=>i.j2.currentUser,g=async e=>{try{let r=await (0,a.x7)((0,a.doc)(i.db,"users",e));if(r.exists())return r.data();return null}catch(e){return console.error("Error getting user data:",e),null}},w=async e=>{try{let r=await g(e);return(null==r?void 0:r.role)||"user"}catch(e){return console.error("Error checking user role:",e),"user"}},f=async e=>{try{let r=await g(e);return(null==r?void 0:r.accountType)||"user"}catch(e){return console.error("Error checking account type:",e),"user"}},p=async e=>"admin"===await w(e),y=async e=>["personal_seller","brand","company"].includes(await f(e))},98868:(e,r,o)=>{o.d(r,{n:()=>n});var t=o(88693),a=o(35317),i=o(25610);let s=new Map,l=new Map,n=(0,t.vt)((e,r)=>({profile:null,loading:!1,error:null,fetchProfile:async r=>{var o,t;if(s.get(r))return void console.log("\uD83D\uDEAB BLOCKED: Already fetching profile for:",r);e({loading:!0,error:null});let n=l.get(r);if(n){console.log("\uD83D\uDCBE CACHE HIT: Using cached profile for:",r),e({profile:n,loading:!1,error:null});return}console.log("\uD83D\uDD0D Store: Starting fetchProfile for:",r);try{let n=await (0,a.x7)((0,a.doc)(i.db,"users",r));if(n.exists()){let a=n.data(),i=Object.assign(Object.assign({id:r,joinedAt:(null==(o=a.joinedAt)?void 0:o.toDate())||new Date,usernameLastChanged:null==(t=a.usernameLastChanged)?void 0:t.toDate()},a),{customPhotoURL:a.customPhotoURL||"",photoURL:a.photoURL||"",profilePic:a.profilePic||"",avatar:a.avatar||"",name:a.name&&"string"==typeof a.name&&a.name.trim()||"User",bio:a.bio&&"string"==typeof a.bio?a.bio.trim():"",followers:Array.isArray(a.followers)?a.followers:[],following:Array.isArray(a.following)?a.following:[]});console.log("✅ Store: Profile loaded successfully:",i.name,i.id),l.set(r,i),e({profile:i,loading:!1})}else console.log("❌ Store: Profile document does not exist for:",r),s.delete(r),e({profile:null,loading:!1,error:"Profile not found. This user may not exist or their profile may be private."})}catch(o){console.error("❌ Store: Firestore error:",o),s.delete(r),e({profile:null,loading:!1,error:"Failed to load profile. Please check your internet connection and try again."})}},subscribeToProfile:e=>(console.log("\uD83D\uDD14 Subscription disabled to prevent infinite loops for:",e),()=>{}),updateProfile:async(o,t)=>{try{await (0,a.mZ)((0,a.doc)(i.db,"users",o),t);let s=r().profile;s&&s.id===o&&e({profile:Object.assign(Object.assign({},s),t)})}catch(e){throw console.error("Error updating profile:",e),e}},createProfile:async(r,o)=>{try{let t=Object.assign(Object.assign({},o),{id:r,joinedAt:new Date});await (0,a.BN)((0,a.doc)(i.db,"users",r),t),e({profile:t,loading:!1,error:null})}catch(r){console.error("Error creating profile:",r),e({error:"Failed to create profile",loading:!1})}},followUser:async(o,t)=>{try{let s=(0,a.doc)(i.db,"users",o),l=(0,a.doc)(i.db,"users",t);await (0,a.mZ)(s,{following:(0,a.hq)(t)}),await (0,a.mZ)(l,{followers:(0,a.hq)(o)});let n=r().profile;if(n&&n.id===o){let r=Array.isArray(n.following)?n.following:[];e({profile:Object.assign(Object.assign({},n),{following:[...r.filter(e=>e!==t),t]})})}}catch(e){throw console.error("Error following user:",e),e}},unfollowUser:async(o,t)=>{try{let s=(0,a.doc)(i.db,"users",o),l=(0,a.doc)(i.db,"users",t);await (0,a.mZ)(s,{following:(0,a.C3)(t)}),await (0,a.mZ)(l,{followers:(0,a.C3)(o)});let n=r().profile;if(n&&n.id===o){let r=Array.isArray(n.following)?n.following:[];e({profile:Object.assign(Object.assign({},n),{following:r.filter(e=>e!==t)})})}}catch(e){throw console.error("Error unfollowing user:",e),e}},fetchUserAnalytics:async e=>{try{return{monthlySales:0,monthlyOrders:0,monthlyRefunds:0,topProducts:[]}}catch(e){throw console.error("Error fetching analytics:",e),e}},clearProfile:()=>{e({profile:null,loading:!1,error:null})},clearUserCache:e=>{l.delete(e),s.delete(e),console.log("\uD83D\uDDD1️ Cleared cache and tracker for:",e)}}))}}]);